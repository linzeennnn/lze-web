((e,t)=>{"undefined"!=typeof module?module.exports=t():"function"==typeof define&&"object"==typeof define.amd?define(t):this.streamSaver=t()})(0,()=>{"use strict";const t="object"==typeof window?window:this;t.HTMLElement||console.warn("streamsaver is meant to run on browsers main thread");let e=null,o=!1;const c=t.WebStreamsPolyfill||{},i=t.isSecureContext;let s=/constructor/i.test(t.HTMLElement)||!!t.safari||!!t.WebKitPoint;const a=i||"MozAppearance"in document.documentElement.style?"iframe":"navigate",n={createWriteStream:function(c,l,d){let u={size:null,pathname:null,writableStrategy:void 0,readableStrategy:void 0},p=0,m=null,h=null,f=null;if(Number.isFinite(l)?([d,l]=[l,d],console.warn("[StreamSaver] Depricated pass an object as 2nd argument when creating a write stream"),u.size=d,u.writableStrategy=l):l&&l.highWaterMark?(console.warn("[StreamSaver] Depricated pass an object as 2nd argument when creating a write stream"),u.size=d,u.writableStrategy=l):u=l||{},!s){e||(e=i?r(n.mitm):function(e){const i="width=200,height=100",s=document.createDocumentFragment(),n={frame:t.open(e,"popup",i),loaded:!1,isIframe:!1,isPopup:!0,remove(){n.frame.close()},addEventListener(...e){s.addEventListener(...e)},dispatchEvent(...e){s.dispatchEvent(...e)},removeEventListener(...e){s.removeEventListener(...e)},postMessage(...e){n.frame.postMessage(...e)}},o=e=>{e.source===n.frame&&(n.loaded=!0,t.removeEventListener("message",o),n.dispatchEvent(new Event("load")))};return t.addEventListener("message",o),n}(n.mitm)),h=new MessageChannel,c=encodeURIComponent(c.replace(/\//g,":")).replace(/['()]/g,escape).replace(/\*/g,"%2A");const s={transferringReadable:o,pathname:u.pathname||Math.random().toString().slice(-6)+"/"+c,headers:{"Content-Type":"application/octet-stream; charset=utf-8","Content-Disposition":"attachment; filename*=UTF-8''"+c}};u.size&&(s.headers["Content-Length"]=u.size);const l=[s,"*",[h.port2]];if(o){const t="iframe"===a?void 0:{transform(e,t){if(!(e instanceof Uint8Array))throw new TypeError("Can only wirte Uint8Arrays");p+=e.length,t.enqueue(e),m&&(location.href=m,m=null)},flush(){m&&(location.href=m)}};f=new n.TransformStream(t,u.writableStrategy,u.readableStrategy);const e=f.readable;h.port1.postMessage({readableStream:e},[e])}h.port1.onmessage=t=>{t.data.download&&("navigate"===a?(e.remove(),e=null,p?location.href=t.data.download:m=t.data.download):(e.isPopup&&(e.remove(),e=null,"iframe"===a&&r(n.mitm)),r(t.data.download)))},e.loaded?e.postMessage(...l):e.addEventListener("load",()=>{e.postMessage(...l)},{once:!0})}let g=[];return!s&&f&&f.writable||new n.WritableStream({write(e){if(!(e instanceof Uint8Array))throw new TypeError("Can only wirte Uint8Arrays");s?g.push(e):(h.port1.postMessage(e),p+=e.length,m&&(location.href=m,m=null))},close(){if(s){const t=new Blob(g,{type:"application/octet-stream; charset=utf-8"}),e=document.createElement("a");e.href=URL.createObjectURL(t),e.download=c,e.click()}else h.port1.postMessage("end")},abort(){g=[],h.port1.postMessage("abort"),h.port1.onmessage=null,h.port1.close(),h.port2.close(),h=null}},u.writableStrategy)},WritableStream:t.WritableStream||c.WritableStream,supported:!0,version:{full:"2.0.5",major:2,minor:0,dot:5},mitm:"https://jimmywarting.github.io/StreamSaver.js/mitm.html?version=2.0.0"};function r(e){if(!e)throw new Error("meh");const t=document.createElement("iframe");return t.hidden=!0,t.src=e,t.loaded=!1,t.name="iframe",t.isIframe=!0,t.postMessage=(...e)=>t.contentWindow.postMessage(...e),t.addEventListener("load",()=>{t.loaded=!0},{once:!0}),document.body.appendChild(t),t}try{new Response(new ReadableStream),i&&!("serviceWorker"in navigator)&&(s=!0)}catch{s=!0}return(e=>{try{e()}catch{}})(()=>{const{readable:t}=new TransformStream,e=new MessageChannel;e.port1.postMessage(t,[t]),e.port1.close(),e.port2.close(),o=!0,Object.defineProperty(n,"TransformStream",{configurable:!1,writable:!1,value:TransformStream})}),n})