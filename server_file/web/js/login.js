function send_pass(e,t){if(e!=="lze"&&e!=="admin"){notify("游客登陆");return}const n={name:e,password:t};fetch(`${protocol}//${ip}/server/login/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then(e=>{if(e.status===401)throw notify("密码错误"),new Error("Unauthorized");return e.json()}).then(t=>{notify("已登陆"),localStorage.setItem("user",e),localStorage.setItem("token",t.token),reloadPage()}).catch(e=>{console.error("Error:",e)})}function log_out(){localStorage.removeItem("user"),localStorage.removeItem("token"),notify("已登出"),reloadPage()}function loginwindow(){const f=document.createElement("div");f.id="login-box";const h=document.createElement("div");h.classList.add("log-tit-box");const n=document.createElement("div");n.id="ip-box",n.classList.add("log-switch-box");const v=document.createElement("div");v.id="ip-icon",v.classList.add("log-switch-icon");const u=document.createElement("span");u.id="ip-bar",u.classList.add("log-switch-span"),u.title="切换主机",u.textContent="127.0.0.1";const i=document.createElement("div");i.id="user-box",i.classList.add("log-switch-box");const g=document.createElement("div");g.id="user-icon",g.classList.add("log-switch-icon");const c=document.createElement("span");c.id="user-name",c.classList.add("log-switch-span"),c.title="切换用户",c.textContent=user;const m=document.createElement("div");m.id="logout",m.title="退出登陆",m.onclick=function(){confirm("确定退出登陆吗")&&log_out()},h.appendChild(n),n.appendChild(v),n.appendChild(u),h.appendChild(i),i.appendChild(g),i.appendChild(c),h.appendChild(m);const e=document.createElement("div");e.id="login-opt-box";const l=document.createElement("div");l.id="ip-input-box",l.classList.add("log-box");const d=document.createElement("input");d.type="text",d.placeholder="输入主机名",d.classList.add("login-input"),d.id="ip-input";const r=document.createElement("div");r.id="ip-send",r.classList.add("log-btn"),r.title="链接ip";const p=document.createElement("div");p.classList.add("send-icon"),r.appendChild(p),l.appendChild(d),l.appendChild(r);const a=document.createElement("div");a.id="login-input-box",a.classList.add("log-box");const o=document.createElement("input");o.type="text",o.placeholder="用户名",o.classList.add("login-input"),o.id="user-input";const s=document.createElement("input");s.type="password",s.placeholder="密码",s.classList.add("login-input"),s.id="pass-input";const t=document.createElement("div");t.id="login-send",t.classList.add("log-btn"),t.title="登陆",t.onclick=function(){send_pass(o.value,s.value)},n.onclick=function(){e.innerHTML="",e.appendChild(l)},i.onclick=function(){e.innerHTML="",e.appendChild(a)},t.appendChild(p.cloneNode()),a.appendChild(o),a.appendChild(s),a.appendChild(t),f.appendChild(h),f.appendChild(e),newwindow(f,1)}