((e,t)=>{"undefined"!=typeof module?module.exports=t():"function"==typeof define&&"object"==typeof define.amd?define(t):this.streamSaver=t()})(0,()=>{"use strict";function e(e){if(!e)throw new Error("meh");const t=document.createElement("iframe");return t.hidden=!0,t.src=e,t.loaded=!1,t.name="iframe",t.isIframe=!0,t.postMessage=((...e)=>t.contentWindow.postMessage(...e)),t.addEventListener("load",()=>{t.loaded=!0},{once:!0}),document.body.appendChild(t),t}const t="object"==typeof window?window:this;t.HTMLElement||console.warn("streamsaver is meant to run on browsers main thread");let a=null,r=!1;const n=t.WebStreamsPolyfill||{},o=t.isSecureContext;let s=/constructor/i.test(t.HTMLElement)||!!t.safari||!!t.WebKitPoint;const i=o||"MozAppearance"in document.documentElement.style?"iframe":"navigate",l={createWriteStream:function(n,m,c){let d={size:null,pathname:null,writableStrategy:void 0,readableStrategy:void 0},p=0,u=null,f=null,g=null;if(Number.isFinite(m)?([c,m]=[m,c],console.warn("[StreamSaver] Depricated pass an object as 2nd argument when creating a write stream"),d.size=c,d.writableStrategy=m):m&&m.highWaterMark?(console.warn("[StreamSaver] Depricated pass an object as 2nd argument when creating a write stream"),d.size=c,d.writableStrategy=m):d=m||{},!s){a||(a=o?e(l.mitm):function(e){const a="width=200,height=100",r=document.createDocumentFragment(),n={frame:t.open(e,"popup",a),loaded:!1,isIframe:!1,isPopup:!0,remove(){n.frame.close()},addEventListener(...e){r.addEventListener(...e)},dispatchEvent(...e){r.dispatchEvent(...e)},removeEventListener(...e){r.removeEventListener(...e)},postMessage(...e){n.frame.postMessage(...e)}},o=e=>{e.source===n.frame&&(n.loaded=!0,t.removeEventListener("message",o),n.dispatchEvent(new Event("load")))};return t.addEventListener("message",o),n}(l.mitm)),f=new MessageChannel,n=encodeURIComponent(n.replace(/\//g,":")).replace(/['()]/g,escape).replace(/\*/g,"%2A");const s={transferringReadable:r,pathname:d.pathname||Math.random().toString().slice(-6)+"/"+n,headers:{"Content-Type":"application/octet-stream; charset=utf-8","Content-Disposition":"attachment; filename*=UTF-8''"+n}};d.size&&(s.headers["Content-Length"]=d.size);const m=[s,"*",[f.port2]];if(r){const e="iframe"===i?void 0:{transform(e,t){if(!(e instanceof Uint8Array))throw new TypeError("Can only wirte Uint8Arrays");p+=e.length,t.enqueue(e),u&&(location.href=u,u=null)},flush(){u&&(location.href=u)}};g=new l.TransformStream(e,d.writableStrategy,d.readableStrategy);const t=g.readable;f.port1.postMessage({readableStream:t},[t])}f.port1.onmessage=(t=>{t.data.download&&("navigate"===i?(a.remove(),a=null,p?location.href=t.data.download:u=t.data.download):(a.isPopup&&(a.remove(),a=null,"iframe"===i&&e(l.mitm)),e(t.data.download)))}),a.loaded?a.postMessage(...m):a.addEventListener("load",()=>{a.postMessage(...m)},{once:!0})}let h=[];return!s&&g&&g.writable||new l.WritableStream({write(e){if(!(e instanceof Uint8Array))throw new TypeError("Can only wirte Uint8Arrays");s?h.push(e):(f.port1.postMessage(e),p+=e.length,u&&(location.href=u,u=null))},close(){if(s){const e=new Blob(h,{type:"application/octet-stream; charset=utf-8"}),t=document.createElement("a");t.href=URL.createObjectURL(e),t.download=n,t.click()}else f.port1.postMessage("end")},abort(){h=[],f.port1.postMessage("abort"),f.port1.onmessage=null,f.port1.close(),f.port2.close(),f=null}},d.writableStrategy)},WritableStream:t.WritableStream||n.WritableStream,supported:!0,version:{full:"2.0.5",major:2,minor:0,dot:5},mitm:"https://jimmywarting.github.io/StreamSaver.js/mitm.html?version=2.0.0"};try{new Response(new ReadableStream),o&&!("serviceWorker"in navigator)&&(s=!0)}catch(t){s=!0}return(e=>{try{e()}catch(e){}})(()=>{const{readable:e}=new TransformStream,t=new MessageChannel;t.port1.postMessage(e,[e]),t.port1.close(),t.port2.close(),r=!0,Object.defineProperty(l,"TransformStream",{configurable:!1,writable:!1,value:TransformStream})}),l});