async function widget(e){let t=[1,2,3].map(e=>document.getElementById(`doc-li${e}`)),n=[1,2,3].map(e=>document.getElementById(`not-li${e}`)),o=[1,2,3].map(e=>document.getElementById(`mon-li${e}`)),d=document.getElementById("pic"),i=document.getElementById("img"),l=document.getElementById("tra-li"),c=document.getElementById("bok-li"),a=document.getElementById("disk-li"),r=document.getElementById("disk-bar");try{let p=await fetch(`${protocol}//${ip}/code/home/widget.php`,{method:"POST",headers:{"Content-Type":"text/plain"},body:`${e}`}),s=await p.json();if("all"!=e&&"doc"!=e||t.forEach((e,t)=>{e&&(e.innerText=s[`doc${t+1}`]||"",e.title="下载:"+(s[`doc${t+1}`]||""),e.style.display="")}),"all"!=e&&"pic"!=e||i&&d&&(i.src=`${protocol}//${ip}/file/Pictures/${s.pic1||""}`,d.title="预览:"+(s.pic1||""),d.style.display=""),"all"!=e&&"not"!=e||n.forEach((e,t)=>{e&&(e.innerText=removeext(s[`not${t+1}`]||""),e.title=removeext(s[`not${t+1}`]||""),e.style.display="")}),"all"!=e&&"bok"!=e||c&&(c.innerText=removeext(s.bok1||""),c.title=removeext(s.bok1||""),c.style.display=""),"all"!=e&&"tra"!=e||l&&(l.innerText=s.tra1||"",l.style.display=""),"all"!=e&&"mon"!=e||o.forEach((e,t)=>{e&&(e.innerText=s[`mon${t+1}`]||"",e.title="进程"+(s[`mon${t+1}`]||""),e.style.display="")}),"all"==e&&a&&r){let e=s.used||0,t=s.total||1;a.innerText=(e/Math.pow(10,6)).toFixed(2)+"G / "+(t/Math.pow(10,6)).toFixed(2)+"G",r.style.width=e/t*100+"%"}}catch(e){console.error("发生错误:",e)}}function removeext(e){return e.substring(0,e.lastIndexOf("."))}function widpage(e,t){switch(e){case 1:const n=document.createElement("div");n.classList.add("widget-page"),n.classList.add("option-page"),n.setAttribute("onclick","widpage(0)"),t.addEventListener("click",e=>{e.stopPropagation()}),n.appendChild(t),document.body.appendChild(n);break;case 0:document.body.removeChild(document.querySelector(".widget-page"))}}function pic(){const e=document.createElement("img");e.id="pre-pic",e.src=document.getElementById("img").src,widpage(1,e)}function not(e){const t=e.innerText+".txt",n=document.createElement("div"),o=document.createElement("div"),d=document.createElement("span");o.classList.add("loading"),n.id="pre-note",n.appendChild(d),n.appendChild(o),widpage(1,n),fetch(`${protocol}//${ip}/file/Note/${t}`).then(e=>e.text()).then(e=>{d.innerText=e,o.style.display="none"}).catch(e=>{notify(e)})}function bok(e){const t=e.innerText+".bok",n=document.createElement("div"),o=document.createElement("div");o.classList.add("loading"),n.id="pre-bok",n.appendChild(o),widpage(1,n),fetch(`${protocol}//${ip}/file/Bookmark/${t}`).then(e=>e.text()).then(e=>{o.style.display="none",window.location.href=e}).catch(e=>{notify(e)})}function doc(e){let t=e.innerText;if(t.endsWith("/")){const e=document.createElement("div"),n=document.createElement("div");n.classList.add("loading"),e.id="pre-doc",e.appendChild(n),widpage(1,e),t=t.slice(0,-1),downfolder(t,t)}else window.location.href=`${protocol}//${ip}/code/Documents/doc_download.php?file=${t}&folder=`}const app=document.querySelectorAll(".app"),widgetwid=new ResizeObserver(e=>{e.forEach(e=>{if(e.contentRect.width<400){const t=e.target.querySelectorAll(".panel");t.forEach(e=>{e.style.display="none"})}else{const t=e.target.querySelectorAll(".panel");t.forEach(e=>{e.style.display=""})}})});app.forEach(e=>{widgetwid.observe(e)});const panel=document.querySelectorAll(".panel");panel.forEach(e=>{e.addEventListener("click",e=>{e.stopPropagation()})});