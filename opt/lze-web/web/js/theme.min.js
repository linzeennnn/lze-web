function setcolor(e){let t=document.querySelectorAll(".color");t.forEach(e=>{e.style.filter=""});const o=document.querySelectorAll(".list-page"),l=document.getElementById("phone-back"),n=document.getElementById("dock"),d=document.getElementById("home-btn"),a=document.getElementById("home-bar"),r=document.getElementById("theme-dis");"default"!=e&&e?(color=e,"undefined"!=typeof ishome&&ishome&&(a.style.backgroundColor=`var(--${e})`,d.style.backgroundColor=`var(--${e})`,n.style.backgroundColor=`var(--${e}-nor)`,r.style.backgroundColor=`var(--${e})`,o.forEach(t=>{t.style.backgroundColor=`var(--${e}-page)`})),t=document.getElementById(`${e}`),l.style.backgroundColor=`var(--${e})`,document.body.style.backgroundColor=`var(--${e})`):(color="default","undefined"!=typeof ishome&&ishome&&(a.style.backgroundColor="",d.style.backgroundColor="",n.style.backgroundColor="",r.style.backgroundColor="",o.forEach(e=>{e.style.backgroundColor=""})),t=document.getElementById("default"),l.style.backgroundColor="",document.body.style.backgroundColor="",localStorage.removeItem("color")),t.style.filter="brightness(1.5)"}function setmode(e){const t=document.getElementById("themesheet");switch(e){case"dark":mode=e,t.href=`${sheetpath}dark.css`,darkbtn.style.display="none",lightbtn.style.display="flex";break;case"light":mode=e,t.href=`${sheetpath}light.css`,darkbtn.style.display="flex",lightbtn.style.display="none";break;default:mode="dark",t.href=`${sheetpath}dark.css`,darkbtn.style.display="none",lightbtn.style.display="flex"}}function theme(e,t){"undefined"!=typeof ishome&&ishome&&localStorage.setItem("color",t),localStorage.setItem("mode",e),setmode(e),setcolor(t),document.querySelector('meta[name="theme-color"]').setAttribute("content",metacolor[e][t]),window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.themeColor&&window.webkit.messageHandlers.themeColor.postMessage(metaThemeColor.content)}function showtheme(e){switch(e){case 0:themepage.style.opacity="0",setTimeout(()=>{themepage.style.display=""},1e3);break;case 1:themepage.style.display="flex",setTimeout(()=>{themepage.style.opacity="1"},10)}}function clearLayout(){localStorage.removeItem("layout"),loadLayout(),notify("已恢复初始布局"),"undefined"!=typeof ishome&&ishome&&reloadPage()}function saveLayout(){const e={dock:[],widgetLines:{}};dock.querySelectorAll(".dock-back").forEach(t=>{e.dock.push(t.id)}),widgetLines.forEach((t,o)=>{e.widgetLines[o]=[],t.querySelectorAll(".widget").forEach(t=>{e.widgetLines[o].push(t.id)})}),localStorage.setItem("layout",JSON.stringify(e))}function loadLayout(){const e=localStorage.getItem("layout");if(e){let t=JSON.parse(e);t.dock=t.dock.filter(e=>{const t=document.getElementById(e);return!!t&&(dock.appendChild(t),t.classList.add("dock-back"),t.classList.remove("widget"),!0)}),widgetLines.forEach((e,o)=>{t.widgetLines[o]=t.widgetLines[o].filter(t=>{const o=document.getElementById(t);return!!o&&(e.appendChild(o),o.classList.add("widget"),o.classList.remove("dock-back"),!0)})}),localStorage.setItem("layout",JSON.stringify(t))}}let themePage=document.createElement("div");themePage.id="theme-page",themePage.classList.add("option-page");let themePanel=document.createElement("div");themePanel.id="theme-panel",themePanel.classList.add("list-page");let closeTheme=document.createElement("div");closeTheme.id="close-theme",closeTheme.title="关闭",closeTheme.setAttribute("onclick","showtheme(0)");let lightBtn=document.createElement("div");lightBtn.className="theme-list",lightBtn.id="light-btn",lightBtn.setAttribute("onclick","theme('light',color)");let lightIcon=document.createElement("div");lightIcon.id="light-icon";let lightText=document.createElement("span");lightText.innerText="亮模式",lightBtn.appendChild(lightIcon),lightBtn.appendChild(lightText);let darkBtn=document.createElement("div");darkBtn.className="theme-list",darkBtn.id="dark-btn",darkBtn.setAttribute("onclick","theme('dark',color)");let darkIcon=document.createElement("div");darkIcon.id="dark-icon";let darkText=document.createElement("span");darkText.innerText="暗模式",darkBtn.appendChild(darkIcon),darkBtn.appendChild(darkText);let recoverTheme=document.createElement("div");recoverTheme.className="theme-list",recoverTheme.id="recover-theme",recoverTheme.setAttribute("onclick","clearLayout()");let oriTheme=document.createElement("div");oriTheme.id="ori-theme";let recoverText=document.createElement("span");recoverText.innerText="还原布局",recoverTheme.appendChild(oriTheme),recoverTheme.appendChild(recoverText);let colorBar=document.createElement("div");colorBar.id="color-bar";let colors=["default","green","blue","yellow","orange","pink","red"],colorNames=["默认","绿","蓝","黄","橙","粉","红"];colors.forEach((e,t)=>{let o=document.createElement("div");o.id=e,o.className="color",o.title=colorNames[t],o.setAttribute("onclick",`theme(mode,'${e}')`),colorBar.appendChild(o)}),themePanel.appendChild(closeTheme),themePanel.appendChild(lightBtn),themePanel.appendChild(darkBtn),themePanel.appendChild(recoverTheme),themePanel.appendChild(colorBar),themePage.appendChild(themePanel),document.body.appendChild(themePage);const darkbtn=document.getElementById("dark-btn"),lightbtn=document.getElementById("light-btn"),themepage=document.getElementById("theme-page");let sheetpath;sheetpath="undefined"!=typeof ishome&&ishome?"web/home/":"./";