function setcolor(colortheme){let colbtn=document.querySelectorAll(".color");colbtn.forEach(colbtn=>{colbtn.style.filter=""});const listpage=document.querySelectorAll(".list-page"),phoneback=document.getElementById("phone-back"),dock=document.getElementById("dock"),btn=document.getElementById("home-btn"),bar=document.getElementById("home-bar"),widget=document.getElementById("theme-dis");"default"!=colortheme&&colortheme?(color=colortheme,"undefined"!=typeof ishome&&ishome&&(bar.style.backgroundColor=`var(--${colortheme})`,btn.style.backgroundColor=`var(--${colortheme})`,dock.style.backgroundColor=`var(--${colortheme}-nor)`,widget.style.backgroundColor=`var(--${colortheme})`,listpage.forEach(listpage=>{listpage.style.backgroundColor=`var(--${colortheme}-page)`})),colbtn=document.getElementById(`${colortheme}`),phoneback.style.backgroundColor=`var(--${colortheme})`,document.body.style.backgroundColor=`var(--${colortheme})`):(color="default","undefined"!=typeof ishome&&ishome&&(bar.style.backgroundColor="",btn.style.backgroundColor="",dock.style.backgroundColor="",widget.style.backgroundColor="",listpage.forEach(listpage=>{listpage.style.backgroundColor=""})),colbtn=document.getElementById("default"),phoneback.style.backgroundColor="",document.body.style.backgroundColor="",localStorage.removeItem("color")),colbtn.style.filter="brightness(1.5)"}function setmode(thememode){const themesheet=document.getElementById("themesheet");switch(thememode){case"dark":mode=thememode,themesheet.href=`${sheetpath}dark.css`,darkbtn.style.display="none",lightbtn.style.display="flex";break;case"light":mode=thememode,themesheet.href=`${sheetpath}light.css`,darkbtn.style.display="flex",lightbtn.style.display="none";break;default:mode="dark",themesheet.href=`${sheetpath}dark.css`,darkbtn.style.display="none",lightbtn.style.display="flex"}}function theme(newmode,newcolor){"undefined"!=typeof ishome&&ishome&&localStorage.setItem("color",newcolor),localStorage.setItem("mode",newmode),setmode(newmode),setcolor(newcolor),document.querySelector('meta[name="theme-color"]').setAttribute("content",metacolor[newmode][newcolor]),window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.themeColor&&window.webkit.messageHandlers.themeColor.postMessage(metaThemeColor.content)}function showtheme(status){switch(status){case 0:themepage.style.opacity="0",setTimeout(()=>{themepage.style.display=""},1e3);break;case 1:themepage.style.display="flex",setTimeout(()=>{themepage.style.opacity="1"},10)}}function clearLayout(){localStorage.removeItem("layout"),loadLayout(),notify("已恢复初始布局"),"undefined"!=typeof ishome&&ishome&&reloadPage()}function saveLayout(){const layout={dock:[],widgetLines:{}};dock.querySelectorAll(".dock-back").forEach(item=>{layout.dock.push(item.id)}),widgetLines.forEach((line,index)=>{layout.widgetLines[index]=[],line.querySelectorAll(".widget").forEach(item=>{layout.widgetLines[index].push(item.id)})}),localStorage.setItem("layout",JSON.stringify(layout))}function loadLayout(){const savedLayout=localStorage.getItem("layout");if(savedLayout){let layout=JSON.parse(savedLayout);layout.dock=layout.dock.filter(id=>{const item=document.getElementById(id);return!!item&&(dock.appendChild(item),item.classList.add("dock-back"),item.classList.remove("widget"),!0)}),widgetLines.forEach((line,index)=>{layout.widgetLines[index]=layout.widgetLines[index].filter(id=>{const item=document.getElementById(id);return!!item&&(line.appendChild(item),item.classList.add("widget"),item.classList.remove("dock-back"),!0)})}),localStorage.setItem("layout",JSON.stringify(layout))}}let themePage=document.createElement("div");themePage.id="theme-page",themePage.classList.add("option-page");let themePanel=document.createElement("div");themePanel.id="theme-panel",themePanel.classList.add("list-page");let closeTheme=document.createElement("div");closeTheme.id="close-theme",closeTheme.title="关闭",closeTheme.setAttribute("onclick","showtheme(0)");let lightBtn=document.createElement("div");lightBtn.className="theme-list",lightBtn.id="light-btn",lightBtn.setAttribute("onclick","theme('light',color)");let lightIcon=document.createElement("div");lightIcon.id="light-icon";let lightText=document.createElement("span");lightText.innerText="亮模式",lightBtn.appendChild(lightIcon),lightBtn.appendChild(lightText);let darkBtn=document.createElement("div");darkBtn.className="theme-list",darkBtn.id="dark-btn",darkBtn.setAttribute("onclick","theme('dark',color)");let darkIcon=document.createElement("div");darkIcon.id="dark-icon";let darkText=document.createElement("span");darkText.innerText="暗模式",darkBtn.appendChild(darkIcon),darkBtn.appendChild(darkText);let recoverTheme=document.createElement("div");recoverTheme.className="theme-list",recoverTheme.id="recover-theme",recoverTheme.setAttribute("onclick","clearLayout()");let oriTheme=document.createElement("div");oriTheme.id="ori-theme";let recoverText=document.createElement("span");recoverText.innerText="还原布局",recoverTheme.appendChild(oriTheme),recoverTheme.appendChild(recoverText);let colorBar=document.createElement("div");colorBar.id="color-bar";let colors=["default","green","blue","yellow","orange","pink","red"],colorNames=["默认","绿","蓝","黄","橙","粉","红"];colors.forEach((color,index)=>{let colorDiv=document.createElement("div");colorDiv.id=color,colorDiv.className="color",colorDiv.title=colorNames[index],colorDiv.setAttribute("onclick",`theme(mode,'${color}')`),colorBar.appendChild(colorDiv)}),themePanel.appendChild(closeTheme),themePanel.appendChild(lightBtn),themePanel.appendChild(darkBtn),themePanel.appendChild(recoverTheme),themePanel.appendChild(colorBar),themePage.appendChild(themePanel),document.body.appendChild(themePage);const darkbtn=document.getElementById("dark-btn"),lightbtn=document.getElementById("light-btn"),themepage=document.getElementById("theme-page");let sheetpath;sheetpath="undefined"!=typeof ishome&&ishome?"web/home/":"./";