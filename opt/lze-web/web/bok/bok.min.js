function optionbar(status){const optionbar=document.getElementById("option-bar"),openbtn=document.getElementById("openbar");switch(status){case 0:allmove(status),optionstatus=0,openbtn.style.display="block",optionbar.style.left="",setTimeout(()=>{optionbar.style.display="none"},1e3);break;case 1:allmove(status),optionstatus=1,optionbar.style.display="",setTimeout(()=>{openbtn.style.display="none",optionbar.style.left="0"},10)}}function allmove(status){const elements=document.querySelectorAll(".main");switch(status){case 1:elements.forEach(function(element,index){element&&(element.style.marginLeft="")});break;case 0:elements.forEach(function(element,index){element.style.marginLeft="0"})}}function handleScroll(){var scrollTop=window.scrollY||document.documentElement.scrollTop;scrollTop>100?(document.getElementById("top-btn").style.bottom="7%",document.getElementById("top-bar").style.top="10px",document.getElementById("top-bar").style.marginLeft="20%",document.getElementById("top-bar").style.width="65%",document.getElementById("top-bar").style.backgroundColor="transparent",document.getElementById("top-bar").style.boxShadow="none",document.querySelector(".backbtn").style.left="1%",document.querySelector(".backbtn").style.width="15%",document.getElementById("cover-bar").style.top="0"):(document.getElementById("top-btn").style.bottom="",document.getElementById("top-bar").style.top="",document.getElementById("top-bar").style.marginLeft="",document.getElementById("top-bar").style.width="80%",document.getElementById("top-bar").style.backgroundColor="",document.getElementById("top-bar").style.boxShadow="",document.querySelector(".backbtn").style.left="5%",document.querySelector(".backbtn").style.width="",document.getElementById("cover-bar").style.top="")}function handleScroll(){var scrollTop=window.scrollY||document.documentElement.scrollTop;scrollTop>100?(document.getElementById("top-btn").style.bottom="15%",document.getElementById("top-bar").style.top="10px",document.getElementById("top-bar").style.backgroundColor="transparent",document.getElementById("top-bar").style.boxShadow="none",document.getElementById("top-bar").style.backdropFilter="none",document.getElementById("top-bar").style.webkitBackdropFilter="none",document.querySelector(".backbtn").style.left="1%",document.getElementById("cover-bar").style.top="0"):(document.getElementById("top-btn").style.bottom="",document.getElementById("top-bar").style.top="100px",document.getElementById("top-bar").style.backgroundColor="",document.getElementById("top-bar").style.boxShadow="",document.querySelector(".backbtn").style.left="5%",document.getElementById("cover-bar").style.top="",document.getElementById("top-bar").style.backdropFilter="",document.getElementById("top-bar").style.webkitBackdropFilter="")}function comin(){pageloading(1),getbok(),theme(mode,"red"),document.getElementById("top-bar").style.top="100px",document.getElementById("option-bar").style.left="0",document.getElementById("option-bar").style.opacity="1",document.querySelector(".backbtn").style.left="5%",document.getElementById("notes").style.right="0px",loginstatus()}function totop(){window.scroll({top:0,left:0,behavior:"smooth"})}function goBack(){window.location.replace(`../../index.html#${ip}`)}function reloadPage(){location.reload()}async function readFile(file){const response=await fetch(file),text=await response.text();return text}async function getbok(){const bokbox=document.getElementById("bok-box");bokbox.innerHTML="";try{const response=await fetch(`${protocol}//${ip}/code/Bookmark/getbok.php`);response.ok||notify("获取失败");const fileData=await response.json();document.getElementById("fileList");fileData.forEach(file=>{const bok=document.createElement("div"),tit=document.createElement("span"),del=document.createElement("div");titname=file.name.split(".").slice(0,-1).join(".")||file.name,bok.classList.add("bok"),tit.classList.add("tit"),del.classList.add("del"),del.title="删除"+titname,bok.title="打开"+titname,tit.innerText=titname,del.addEventListener("click",function(event){event.stopPropagation()}),bok.addEventListener("click",function(){updatebok(file.name),file.content.startsWith("http")||(file.content="http://"+file.content),window.location.href=file.content}),del.addEventListener("click",function(){confirm("确定要删除书签吗？")&&delbok(file.name)}),bok.appendChild(tit),bok.appendChild(del),bokbox.appendChild(bok),pageloading(0)})}catch(error){console.log(error),notify(error)}}async function updatebok(name){try{await fetch(`${protocol}//${ip}/code/Bookmark/update.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(name)})}catch(error){notify(error)}}function delbok(name){pageloading(1),fetch(`${protocol}//${ip}/code/Bookmark/del.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:name})}).then(response=>response.json()).then(data=>{notify(data.message),getbok()}).catch(error=>{console.error("Error:",error)})}function newbok(){pageloading(1);let tit=document.getElementById("tit-bar"),link=document.getElementById("word-bar"),name=tit.value,text=link.innerText;name=tit.value+".bok",text=link.innerText,""==tit.value&&(name="new_bookmark.bok"),tit.value="",link.innerText="",fetch(`${protocol}//${ip}/code/Bookmark/new.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:name,text:text})}).then(response=>response.json()).then(data=>{console.log(data.message),notify(data.message),getbok()}).catch(error=>{notify(error)})}window.addEventListener("scroll",handleScroll),window.addEventListener("scroll",handleScroll),window.onload=comin;