function optionbar(t){const e=document.getElementById("option-bar"),o=document.getElementById("openbar");switch(t){case 0:allmove(t),optionstatus=0,o.style.display="block",e.style.left="",setTimeout(()=>{e.style.display="none"},1e3);break;case 1:allmove(t),optionstatus=1,e.style.display="",setTimeout(()=>{o.style.display="none",e.style.left="0"},10)}}function allmove(t){const e=document.querySelectorAll(".main");switch(t){case 1:e.forEach(function(t,e){t&&(t.style.marginLeft="")});break;case 0:e.forEach(function(t,e){t.style.marginLeft="0"})}}function handleScroll(){var t=window.scrollY||document.documentElement.scrollTop;t>100?(document.getElementById("top-btn").style.bottom="7%",document.getElementById("top-bar").style.top="10px",document.getElementById("top-bar").style.marginLeft="20%",document.getElementById("top-bar").style.width="65%",document.getElementById("top-bar").style.backgroundColor="transparent",document.getElementById("top-bar").style.boxShadow="none",document.querySelector(".backbtn").style.left="1%",document.querySelector(".backbtn").style.width="15%",document.getElementById("cover-bar").style.top="0"):(document.getElementById("top-btn").style.bottom="",document.getElementById("top-bar").style.top="",document.getElementById("top-bar").style.marginLeft="",document.getElementById("top-bar").style.width="80%",document.getElementById("top-bar").style.backgroundColor="",document.getElementById("top-bar").style.boxShadow="",document.querySelector(".backbtn").style.left="5%",document.querySelector(".backbtn").style.width="",document.getElementById("cover-bar").style.top="")}function handleScroll(){var t=window.scrollY||document.documentElement.scrollTop;t>100?(document.getElementById("top-btn").style.bottom="15%",document.getElementById("top-bar").style.top="10px",document.getElementById("top-bar").style.backgroundColor="transparent",document.getElementById("top-bar").style.boxShadow="none",document.getElementById("top-bar").style.backdropFilter="none",document.getElementById("top-bar").style.webkitBackdropFilter="none",document.querySelector(".backbtn").style.left="1%",document.getElementById("cover-bar").style.top="0"):(document.getElementById("top-btn").style.bottom="",document.getElementById("top-bar").style.top="100px",document.getElementById("top-bar").style.backgroundColor="",document.getElementById("top-bar").style.boxShadow="",document.querySelector(".backbtn").style.left="5%",document.getElementById("cover-bar").style.top="",document.getElementById("top-bar").style.backdropFilter="",document.getElementById("top-bar").style.webkitBackdropFilter="")}function comin(){pageloading(1),getbok(),theme(mode,"red"),document.getElementById("top-bar").style.top="100px",document.getElementById("option-bar").style.left="0",document.getElementById("option-bar").style.opacity="1",document.querySelector(".backbtn").style.left="5%",document.getElementById("notes").style.right="0px",loginstatus()}function totop(){window.scroll({top:0,left:0,behavior:"smooth"})}function goBack(){window.location.replace(`../../index.html#${ip}`)}function reloadPage(){location.reload()}async function readFile(t){const e=await fetch(t),o=await e.text();return o}async function getbok(){const t=document.getElementById("bok-box");t.innerHTML="";try{const e=await fetch(`${protocol}//${ip}/code/Bookmark/getbok.php`);e.ok||notify("获取失败");const o=await e.json();document.getElementById("fileList");o.forEach(e=>{const o=document.createElement("div"),n=document.createElement("span"),l=document.createElement("div");titname=e.name.split(".").slice(0,-1).join(".")||e.name,o.classList.add("bok"),n.classList.add("tit"),l.classList.add("del"),l.title="删除"+titname,o.title="打开"+titname,n.innerText=titname,l.addEventListener("click",function(t){t.stopPropagation()}),o.addEventListener("click",function(){updatebok(e.name),e.content.startsWith("http")||(e.content="http://"+e.content),window.location.href=e.content}),l.addEventListener("click",function(){confirm("确定要删除书签吗？")&&delbok(e.name)}),o.appendChild(n),o.appendChild(l),t.appendChild(o),pageloading(0)})}catch(t){console.log(t),notify(t)}}async function updatebok(t){try{await fetch(`${protocol}//${ip}/code/Bookmark/update.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}catch(t){notify(t)}}function delbok(t){pageloading(1),fetch(`${protocol}//${ip}/code/Bookmark/del.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t})}).then(t=>t.json()).then(t=>{notify(t.message),getbok()}).catch(t=>{console.error("Error:",t)})}function newbok(){pageloading(1);let t=document.getElementById("tit-bar"),e=document.getElementById("word-bar"),o=t.value,n=e.innerText;o=t.value+".bok",n=e.innerText,""==t.value&&(o="new_bookmark.bok"),t.value="",e.innerText="",fetch(`${protocol}//${ip}/code/Bookmark/new.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:o,text:n})}).then(t=>t.json()).then(t=>{console.log(t.message),notify(t.message),getbok()}).catch(t=>{notify(t)})}window.addEventListener("scroll",handleScroll),window.addEventListener("scroll",handleScroll),window.onload=comin;