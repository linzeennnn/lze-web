function optionbar(e){const t=document.getElementById("option-bar"),o=document.getElementById("openbar");switch(e){case 0:allmove(e),optionstatus=0,o.style.display="block",t.style.left="",setTimeout(()=>{t.style.display="none"},1e3);break;case 1:allmove(e),optionstatus=1,t.style.display="",setTimeout(()=>{o.style.display="none",t.style.left="0"},10)}}function allmove(e){const t=document.querySelectorAll(".main");switch(e){case 1:t.forEach(function(e,t){e&&(e.style.marginLeft="")});break;case 0:t.forEach(function(e,t){e.style.marginLeft="0"})}}function handleScroll(){var e=window.scrollY||document.documentElement.scrollTop;e>100?(document.getElementById("top-btn").style.bottom="10%",document.querySelector(".backbtn").style.left="1%",document.querySelector(".backbtn").style.width="15%",document.getElementById("cover-bar").style.top="0",topbar.style.top="0",topbar.style.flexDirection="row",mediabar.style.backgroundColor="transparent",mediabar.style.margin="0",mediabar.style.top="-5px",mediabar.style.boxShadow="none",mediabar.style.backdropFilter="none",mediabar.style.webkitBackdropFilter="none",toolbar.style.padding="0",toolbar.style.backgroundColor="transparent",toolbar.style.margin="0",toolbar.style.boxShadow="none",toolbar.style.backdropFilter="none",toolbar.style.webkitBackdropFilter="none",btnbar.style.display="none"):(document.getElementById("top-btn").style.bottom="",document.querySelector(".backbtn").style.left="5%",document.querySelector(".backbtn").style.width="",document.getElementById("cover-bar").style.top="",topbar.style.flexDirection="",mediabar.style.margin="",mediabar.style.backgroundColor="",mediabar.style.top="",mediabar.style.boxShadow="",mediabar.style.backdropFilter="",mediabar.style.twebkitBackdropFilter="",topbar.style.top="80px",toolbar.style.backgroundColor="",toolbar.style.padding="",toolbar.style.margin="",toolbar.style.boxShadow="",toolbar.style.backdropFilter="",toolbar.style.webkitBackdropFilter="",btnbar.style.display="")}function comin(){cleanall(),getwin(),mediastatus(),getvalue(),theme(mode,"yellow"),topbar.style.top="80px",allwindow.style.opacity="1",document.getElementById("option-bar").style.left="0",document.getElementById("option-bar").style.opacity="1",document.querySelector(".backbtn").style.left="5%",loginstatus()}function goBack(){window.location.replace(`../../index.html#${ip}`)}function mediastatus(){const e=document.getElementById("play"),t=document.getElementById("pause"),o=new XMLHttpRequest;o.open("POST",`${protocol}//${ip}/code/Monitor/media.php`,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xmltoken(o),o.send("action=status"),o.onreadystatechange=function(){if(4===o.readyState&&200===o.status){const n=o.responseText.trim();"Playing"===n?(e.style.display="none",t.style.display="block",mediatitle()):"Paused"===n?(e.style.display="block",t.style.display="none",mediatitle(),console.log("pause")):(e.style.display="block",t.style.display="none",console.log(n))}}}function mediatitle(){const e=new XMLHttpRequest,t=document.getElementById("media-title");e.open("POST",`${protocol}//${ip}/code/Monitor/media.php`,!0),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xmltoken(e),e.send("action=title"),e.onreadystatechange=function(){if(4===e.readyState&&200===e.status){const o=e.responseText;t.innerText=o,t.style.animation="media-title 7s linear infinite"}pause}}function mediabutton(e){const t=new XMLHttpRequest;let o;switch(t.open("POST",`${protocol}//${ip}/code/Monitor/media.php`,!0),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xmltoken(t),e){case"play":o="action=play";break;case"pause":o="action=pause";break;case"speed":o="action=speed";break;case"slow":o="action=slow";break;default:return void console.error("Unknown buttonId:",e)}t.send(o),t.onreadystatechange=function(){if(xmlnologin(t),4===t.readyState&&200===t.status){t.responseText;setTimeout(()=>{switch(mediastatus(),e){case"play":notify("正在播放");break;case"pause":notify("已暂停");break;case"speed":notify("快进>>10s");break;case"slow":notify("10s<<回退");break;default:return void console.error("Unknown buttonId:",e)}},10)}}}function getwin(){fetch(`${protocol}//${ip}/code/Monitor/window.php`,fetchtoken()).then(e=>(fetchnologin(e),e.json())).then(e=>{const t=document.getElementById("allwindow");e.forEach(e=>{const o=document.createElement("div");o.className="window",o.id=e.windowid,o.onclick=function(){notify("进程"+o.id)};const n=document.createElement("span");n.className="title",n.innerText=e.text,o.appendChild(n);const l=document.createElement("div");l.className="close-win",l.addEventListener("click",()=>{windowid=o.id,console.log("windowid set to:",windowid),t.innerHTML="",closewindow()}),o.appendChild(l),t.appendChild(o)})}).catch(e=>console.error("Error fetching JSON:",e))}function closewindow(){fetch(`${protocol}//${ip}/code/Monitor/close_window.php`,{method:"POST",headers:{Authorization:"Bearer "+token,"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({windowid:windowid})}).then(e=>e.text()).then(e=>{getwin(),notify("已关闭")}).catch(e=>{console.error("Error:",e)})}function createSlider(e,t,o,n,l){function a(t){const o=r.getBoundingClientRect(),n=Math.max(0,Math.min(t-o.left,o.width)),a=n/o.width,i=Math.round(100*a);".volum-bar"===e?volumeValue=i:".brightness-bar"===e&&(brightnessValue=i),d.style.width=`${100*a}%`,l&&l(i)}function i(e){const t=r.getBoundingClientRect(),o=e/100,n=o*t.width;a(t.left+n)}function s(e){e.preventDefault();const t=e.clientX||e.touches&&e.touches[0]&&e.touches[0].clientX;void 0!==t&&a(t)}const r=document.querySelector(e),d=document.querySelector(o);document.querySelector(t);let c=!1;return r.addEventListener("mousedown",e=>{c=!0,s(e)}),r.addEventListener("touchstart",e=>{c=!0,s(e)}),document.addEventListener("mouseup",()=>{c=!1}),document.addEventListener("touchend",()=>{c=!1}),document.addEventListener("mousemove",e=>{c&&s(e)}),document.addEventListener("touchmove",e=>{c&&s(e)}),i(n),{update:e=>{const t=r.getBoundingClientRect(),o=e/100,n=o*t.width;a(t.left+n)},getCurrentValue:()=>".volum-bar"===e?volumeValue:".brightness-bar"===e?brightnessValue:void 0}}function initslider(){const e=createSlider(".volum-bar","#volum-thumb",".volum-fill",volumeValue,e=>{toolkit("volum",volumeValue)}),t=createSlider(".brightness-bar","#brightness-thumb",".brightness-fill",brightnessValue,e=>{toolkit("brightness",brightnessValue)});let o=!1,n=!1;document.getElementById("mute-button").addEventListener("click",()=>{o?(volumeValue=initialVolumeValue,e.update(volumeValue),toolkit("volum",volumeValue)):(initialVolumeValue=volumeValue,volumeValue=0,e.update(volumeValue),toolkit("volum",volumeValue)),o=!o}),document.getElementById("min-brightness-button").addEventListener("click",()=>{n?(brightnessValue=initialBrightnessValue,t.update(brightnessValue),toolkit("brightness",brightnessValue)):(initialBrightnessValue=brightnessValue,brightnessValue=0,t.update(brightnessValue),toolkit("brightness",brightnessValue)),n=!n})}function toolkit(e,t){const o=new XMLHttpRequest;let n;switch(o.open("POST",`${protocol}//${ip}/code/Monitor/toolkit.php`,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xmltoken(o),e){case"volum":n=`action=volume&value=${t}`;break;case"brightness":n=`action=brightness&value=${t}`;break;default:return void console.error("Unknown buttonId:",e)}o.send(n),o.onreadystatechange=function(){o.responseText}}function getvalue(){const e=new XMLHttpRequest;e.open("POST",`${protocol}//${ip}/code/Monitor/toolkit.php`,!0),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xmltoken(e),e.send("action=getvalue"),e.onreadystatechange=function(){if(4===e.readyState&&200===e.status){const t=JSON.parse(e.responseText);volumeValue=t.vo,brightnessValue=t.bri,initslider()}}}function cleanall(){fetch(`${protocol}//${ip}/code/Monitor/cleanfile.php`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+token,"Content-Type":"application/json"}}).catch(e=>{console.error("Error executing PHP script:",e)})}function toscreen(){var e=document.getElementById("uploadfile").files,t=new FormData,o=10485760;toolbar.style.animation="toscreen 1s infinite";for(var n=0;n<e.length;n++){if(e[n].size>o)return alert("File "+e[n].name+"超过10MB"),void(toolbar.style.animation="none");t.append("pic[]",e[n])}var l=new XMLHttpRequest;l.open("POST",`${protocol}//${ip}/code/Monitor/toscreen.php`,!0),xmltoken(l),l.onload=function(){l.readyState===XMLHttpRequest.DONE&&(xmlnologin(l),200===l.status?toolbar.style.animation="none":console.error("Failed to upload files"))},l.send(t)}let volumeValue,brightnessValue,windowid="";const toolbar=document.getElementById("tool-bar"),mediabar=document.getElementById("media-bar"),allwindow=document.getElementById("allwindow"),topbar=document.getElementById("top-bar"),btnbar=document.getElementById("btn-bar");let initialVolumeValue,initialBrightnessValue;window.addEventListener("scroll",handleScroll),window.onload=comin;