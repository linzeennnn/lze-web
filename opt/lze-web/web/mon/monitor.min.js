function optionbar(status){const optionbar=document.getElementById("option-bar"),openbtn=document.getElementById("openbar");switch(status){case 0:allmove(status),optionstatus=0,openbtn.style.display="block",optionbar.style.left="",setTimeout(()=>{optionbar.style.display="none"},1e3);break;case 1:allmove(status),optionstatus=1,optionbar.style.display="",setTimeout(()=>{openbtn.style.display="none",optionbar.style.left="0"},10)}}function allmove(status){const elements=document.querySelectorAll(".main");switch(status){case 1:elements.forEach(function(element,index){element&&(element.style.marginLeft="")});break;case 0:elements.forEach(function(element,index){element.style.marginLeft="0"})}}function handleScroll(){var scrollTop=window.scrollY||document.documentElement.scrollTop;scrollTop>100?(document.getElementById("top-btn").style.bottom="10%",document.querySelector(".backbtn").style.left="1%",document.querySelector(".backbtn").style.width="15%",document.getElementById("cover-bar").style.top="0",topbar.style.top="0",topbar.style.flexDirection="row",mediabar.style.backgroundColor="transparent",mediabar.style.margin="0",mediabar.style.top="-5px",mediabar.style.boxShadow="none",mediabar.style.backdropFilter="none",mediabar.style.webkitBackdropFilter="none",toolbar.style.padding="0",toolbar.style.backgroundColor="transparent",toolbar.style.margin="0",toolbar.style.boxShadow="none",toolbar.style.backdropFilter="none",toolbar.style.webkitBackdropFilter="none",btnbar.style.display="none"):(document.getElementById("top-btn").style.bottom="",document.querySelector(".backbtn").style.left="5%",document.querySelector(".backbtn").style.width="",document.getElementById("cover-bar").style.top="",topbar.style.flexDirection="",mediabar.style.margin="",mediabar.style.backgroundColor="",mediabar.style.top="",mediabar.style.boxShadow="",mediabar.style.backdropFilter="",mediabar.style.twebkitBackdropFilter="",topbar.style.top="80px",toolbar.style.backgroundColor="",toolbar.style.padding="",toolbar.style.margin="",toolbar.style.boxShadow="",toolbar.style.backdropFilter="",toolbar.style.webkitBackdropFilter="",btnbar.style.display="")}function comin(){cleanall(),getwin(),mediastatus(),getvalue(),theme(mode,"yellow"),topbar.style.top="80px",allwindow.style.opacity="1",document.getElementById("option-bar").style.left="0",document.getElementById("option-bar").style.opacity="1",document.querySelector(".backbtn").style.left="5%",loginstatus()}function goBack(){window.location.replace(`../../index.html#${ip}`)}function mediastatus(){const play=document.getElementById("play"),pause=document.getElementById("pause"),xhr=new XMLHttpRequest;xhr.open("POST",`${protocol}//${ip}/code/Monitor/media.php`,!0),xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xmltoken(xhr),xhr.send("action=status"),xhr.onreadystatechange=function(){if(4===xhr.readyState&&200===xhr.status){const response=xhr.responseText.trim();"Playing"===response?(play.style.display="none",pause.style.display="block",mediatitle()):"Paused"===response?(play.style.display="block",pause.style.display="none",mediatitle(),console.log("pause")):(play.style.display="block",pause.style.display="none",console.log(response))}}}function mediatitle(){const xhr=new XMLHttpRequest,title=document.getElementById("media-title");xhr.open("POST",`${protocol}//${ip}/code/Monitor/media.php`,!0),xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xmltoken(xhr),xhr.send("action=title"),xhr.onreadystatechange=function(){if(4===xhr.readyState&&200===xhr.status){const response=xhr.responseText;title.innerText=response,title.style.animation="media-title 7s linear infinite"}pause}}function mediabutton(button){const xhr=new XMLHttpRequest;let postData;switch(xhr.open("POST",`${protocol}//${ip}/code/Monitor/media.php`,!0),xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xmltoken(xhr),button){case"play":postData="action=play";break;case"pause":postData="action=pause";break;case"speed":postData="action=speed";break;case"slow":postData="action=slow";break;default:return void console.error("Unknown buttonId:",button)}xhr.send(postData),xhr.onreadystatechange=function(){if(xmlnologin(xhr),4===xhr.readyState&&200===xhr.status){xhr.responseText;setTimeout(()=>{switch(mediastatus(),button){case"play":notify("正在播放");break;case"pause":notify("已暂停");break;case"speed":notify("快进>>10s");break;case"slow":notify("10s<<回退");break;default:return void console.error("Unknown buttonId:",button)}},10)}}}function getwin(){fetch(`${protocol}//${ip}/code/Monitor/window.php`,fetchtoken()).then(response=>(fetchnologin(response),response.json())).then(data=>{const allwindow=document.getElementById("allwindow");data.forEach(item=>{const window=document.createElement("div");window.className="window",window.id=item.windowid,window.onclick=function(){notify("进程"+window.id)};const span=document.createElement("span");span.className="title",span.innerText=item.text,window.appendChild(span);const close=document.createElement("div");close.className="close-win",close.addEventListener("click",()=>{windowid=window.id,console.log("windowid set to:",windowid),allwindow.innerHTML="",closewindow()}),window.appendChild(close),allwindow.appendChild(window)})}).catch(error=>console.error("Error fetching JSON:",error))}function closewindow(){fetch(`${protocol}//${ip}/code/Monitor/close_window.php`,{method:"POST",headers:{Authorization:"Bearer "+token,"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({windowid:windowid})}).then(response=>response.text()).then(data=>{getwin(),notify("已关闭")}).catch(error=>{console.error("Error:",error)})}function createSlider(sliderSelector,thumbSelector,fillSelector,initialValue,onUpdate){function updateSlider(x){const rect=sliderContainer.getBoundingClientRect(),offsetX=Math.max(0,Math.min(x-rect.left,rect.width)),percentage=offsetX/rect.width,value=Math.round(100*percentage);".volum-bar"===sliderSelector?volumeValue=value:".brightness-bar"===sliderSelector&&(brightnessValue=value),sliderFill.style.width=`${100*percentage}%`,onUpdate&&onUpdate(value)}function setInitialValue(value){const rect=sliderContainer.getBoundingClientRect(),percentage=value/100,offsetX=percentage*rect.width;updateSlider(rect.left+offsetX)}function onMove(e){e.preventDefault();const x=e.clientX||e.touches&&e.touches[0]&&e.touches[0].clientX;void 0!==x&&updateSlider(x)}const sliderContainer=document.querySelector(sliderSelector),sliderFill=document.querySelector(fillSelector);document.querySelector(thumbSelector);let isDragging=!1;return sliderContainer.addEventListener("mousedown",e=>{isDragging=!0,onMove(e)}),sliderContainer.addEventListener("touchstart",e=>{isDragging=!0,onMove(e)}),document.addEventListener("mouseup",()=>{isDragging=!1}),document.addEventListener("touchend",()=>{isDragging=!1}),document.addEventListener("mousemove",e=>{isDragging&&onMove(e)}),document.addEventListener("touchmove",e=>{isDragging&&onMove(e)}),setInitialValue(initialValue),{update:value=>{const rect=sliderContainer.getBoundingClientRect(),percentage=value/100,offsetX=percentage*rect.width;updateSlider(rect.left+offsetX)},getCurrentValue:()=>".volum-bar"===sliderSelector?volumeValue:".brightness-bar"===sliderSelector?brightnessValue:void 0}}function initslider(){const volumeSlider=createSlider(".volum-bar","#volum-thumb",".volum-fill",volumeValue,value=>{toolkit("volum",volumeValue)}),brightnessSlider=createSlider(".brightness-bar","#brightness-thumb",".brightness-fill",brightnessValue,value=>{toolkit("brightness",brightnessValue)});let muteActive=!1,minBrightnessActive=!1;document.getElementById("mute-button").addEventListener("click",()=>{muteActive?(volumeValue=initialVolumeValue,volumeSlider.update(volumeValue),toolkit("volum",volumeValue)):(initialVolumeValue=volumeValue,volumeValue=0,volumeSlider.update(volumeValue),toolkit("volum",volumeValue)),muteActive=!muteActive}),document.getElementById("min-brightness-button").addEventListener("click",()=>{minBrightnessActive?(brightnessValue=initialBrightnessValue,brightnessSlider.update(brightnessValue),toolkit("brightness",brightnessValue)):(initialBrightnessValue=brightnessValue,brightnessValue=0,brightnessSlider.update(brightnessValue),toolkit("brightness",brightnessValue)),minBrightnessActive=!minBrightnessActive})}function toolkit(button,value){const xhr=new XMLHttpRequest;let postData;switch(xhr.open("POST",`${protocol}//${ip}/code/Monitor/toolkit.php`,!0),xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xmltoken(xhr),button){case"volum":postData=`action=volume&value=${value}`;break;case"brightness":postData=`action=brightness&value=${value}`;break;default:return void console.error("Unknown buttonId:",button)}xhr.send(postData),xhr.onreadystatechange=function(){xhr.responseText}}function getvalue(){const xhr=new XMLHttpRequest;xhr.open("POST",`${protocol}//${ip}/code/Monitor/toolkit.php`,!0),xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xmltoken(xhr),xhr.send("action=getvalue"),xhr.onreadystatechange=function(){if(4===xhr.readyState&&200===xhr.status){const response=JSON.parse(xhr.responseText);volumeValue=response.vo,brightnessValue=response.bri,initslider()}}}function cleanall(){fetch(`${protocol}//${ip}/code/Monitor/cleanfile.php`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+token,"Content-Type":"application/json"}}).catch(error=>{console.error("Error executing PHP script:",error)})}function toscreen(){var files=document.getElementById("uploadfile").files,fd=new FormData,maxSize=10485760;toolbar.style.animation="toscreen 1s infinite";for(var i=0;i<files.length;i++){if(files[i].size>maxSize)return alert("File "+files[i].name+"超过10MB"),void(toolbar.style.animation="none");fd.append("pic[]",files[i])}var xhr=new XMLHttpRequest;xhr.open("POST",`${protocol}//${ip}/code/Monitor/toscreen.php`,!0),xmltoken(xhr),xhr.onload=function(){xhr.readyState===XMLHttpRequest.DONE&&(xmlnologin(xhr),200===xhr.status?toolbar.style.animation="none":console.error("Failed to upload files"))},xhr.send(fd)}let volumeValue,brightnessValue,windowid="";const toolbar=document.getElementById("tool-bar"),mediabar=document.getElementById("media-bar"),allwindow=document.getElementById("allwindow"),topbar=document.getElementById("top-bar"),btnbar=document.getElementById("btn-bar");let initialVolumeValue,initialBrightnessValue;window.addEventListener("scroll",handleScroll),window.onload=comin;