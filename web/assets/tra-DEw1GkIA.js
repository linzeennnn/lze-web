import{c as x,j as e,n as d,r as f,W as j,T as g,b as w}from"./all-BL_U5SVG.js";import{P as b,C as P,T as _,S as k,a as y,H as S,G as T,b as N}from"./page-LTMY0JaK.js";const a=x((t,o)=>({userName:window.localStorage.getItem("userName"),token:window.localStorage.getItem("token"),nowPath:"",parentPath:"",fileList:[],uploading:!1,showBg:!1,loading:!1,langList:[],selected:[],source_path:!0,theme:{mode:"",color:{tra:""},userSelect:""},traUrl:`${window.location.origin}/server/tra/`,setGlobal:n=>{t(s=>({...s,...n}))},replaceGlobal:n=>{t(()=>({...n}))},getGlobal:()=>o()}));function i(t){return a.getState().langList[t]}function C(){b(a.setState,"tra"),u("")}function u(t){const o={folder:t},n=a.getState().traUrl;h(!0),fetch(`${n}list`,{method:"POST",body:JSON.stringify(o),headers:{"Content-Type":"application/json"}}).then(s=>s.json()).then(s=>{h(!1);let r;s.currentFolder==""?r=!0:r=!1,a.setState({fileList:s.filelist,nowPath:s.currentFolder,parentPath:s.parentFolder,source_path:r,selected:[]})})}function h(t){a.setState({loading:t,showBg:t})}function B({fileMes:t}){const o=a(n=>n.nowPath);return e.jsxs(e.Fragment,{children:[e.jsx("span",{className:(t.type==="dir"||t.type==="dir_link"?"dir-text":"file-text")+" file-list-text",title:i("view")+t.name,onClick:n=>{if(n.stopPropagation(),t.type==="dir"||t.type==="dir_link"){const s=o+"/"+t.name;u(s)}if(t.type==="file"||t.type==="file_link"){const s=o+"/"+t.name;window.location.href=window.location.origin+"/file/trash"+s}},children:t.name}),e.jsx("span",{className:"ori-path",title:i("ori_path")+":"+t.delData==""?"/":t.delData,children:t.delData==""?"/":t.delData})]})}function v({fileMes:t,selected:o,traClick:n}){const r=a.getState().nowPath+"/"+t.name;return e.jsx("div",{className:`tra-list main-item ${o.includes(r)?"tra-list-selected":""}`,onClick:()=>n(r),children:e.jsx(B,{fileMes:t})},"tralist"+t.name)}function G(){const t=r=>{let l=[...n];l.includes(r)?(l.splice(l.indexOf(r),1),d(i("cancel"))):(l.push(r),d(i("selected")+l.length+i("file"))),s({selected:l})},o=a(r=>r.fileList),n=a(r=>r.selected),s=a(r=>r.setGlobal);return e.jsx(P,{children:o.map(r=>e.jsx(v,{fileMes:r,selected:n,traClick:t},"tralist"+r.name))})}function F(){const t=a(s=>s.nowPath),o=a(s=>s.parentPath),n=t==="/"||t==="";return e.jsx("button",{id:"go-up",className:(n?"go-up-disable":"")+" btn top-bar-widget",disabled:n,title:n?"":i("back"),onClick:()=>{n||u(o)}})}function D(){const t=a(o=>o.nowPath);return e.jsx("div",{id:"show-path",title:t,children:e.jsx("span",{children:t})})}function L(){return e.jsx("button",{className:"btn top-bar-widget",id:"go-home",onClick:()=>{u("")},title:i("back_main_dir")})}function O(){const[t,o]=f.useState(!1);return e.jsxs(_,{children:[e.jsx(F,{}),e.jsx(D,{}),e.jsx(L,{})]})}function E(){const t=a(o=>o.nowPath);return e.jsx("button",{className:"btn  side-btn",id:"load",title:i("refresh"),onClick:()=>{u(t)}})}function I(){const t=a(l=>l.userName),o=a(l=>l.token),n=a(l=>l.nowPath),s=a(l=>l.traUrl)+"del",r=()=>{if(!confirm(i("are_you_sure")))return;h(!0),fetch(s,{method:"POST",body:JSON.stringify({user:t,token:o}),headers:{"Content-Type":"application/json",authorization:"Bearer "+o,"x-user":t}}).then(p=>{if(!p.ok){p.status==401?d(i("no_per")):d(i("error")+":"+p.status),h(!1);return}d(i("op_com")),u(n)})};return e.jsx("button",{id:"del",className:"btn side-btn",onClick:()=>{r()},title:i("clear_tra")})}function U(){const t=a(c=>c.userName),o=a(c=>c.token),n=a(c=>c.selected),s=a(c=>c.source_path),r=a(c=>c.nowPath),l=a(c=>c.traUrl)+"recover",p=()=>{if(n.length==0){d(i("no_select_file"));return}if(!confirm(i("are_you_sure")))return;h(!0),fetch(l,{method:"POST",body:JSON.stringify({user:t,token:o,recover_list:n,source_path:s}),headers:{"Content-Type":"application/json",authorization:"Bearer "+o,"x-user":t}}).then(m=>{if(!m.ok){m.status==401?d(i("no_per")):d(i("error")+":"+m.status),h(!1);return}d(i("op_com")),u(r)})};return e.jsx("button",{className:"btn side-btn",id:"recover",title:i("restore"),onClick:()=>{p()}})}function R(){return e.jsxs(k,{children:[e.jsx(E,{}),e.jsx(I,{}),e.jsx(U,{})]})}function W(){const t=a(n=>n.showBg),o=a(n=>n.loading);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"loading",id:"list-loading",style:o?{display:"block"}:{display:"none"}}),e.jsx(j,{showBg:t})]})}function H(){return e.jsx(e.Fragment,{children:e.jsx(W,{})})}function J(){const t=a(o=>o.theme);return f.useEffect(()=>{C()},[]),e.jsxs("div",{id:"app",mode:t.mode,color:t.color.tra,children:[e.jsx("div",{className:"wallpaper"}),e.jsxs(y,{children:[e.jsx(S,{}),e.jsx(T,{}),e.jsx(N,{}),e.jsx(O,{}),e.jsx(R,{}),e.jsx(G,{}),e.jsx(H,{})]}),e.jsx(g,{})]})}w.createRoot(document.getElementById("root")).render(e.jsx(J,{}));
