import{c as T,s as L,G,I as W,D as E,C as F,a as U,A as p,b as j,d as w,g as C,e as A,j as e,R as D,f as i,n as x,r as u,u as M,h as O,i as R,S as K,W as I,k as _,l as q,P as J,m as z}from"./all-B5MRgsKL.js";const d=T((s,t)=>(window.localStorage.getItem("userName"),window.localStorage.getItem("token"),{load:0,showBg:!1,locked:!0,theme:{mode:"",color:{home:"",doc:"",pic:"",tra:"",mon:"",not:"",bok:""},userSelect:""},listWin:{type:"",name:"",status:!1},widgetData:{doc:[],pic:[],tra:[],mon:[],not:[],bok:[]},setGlobal:a=>{s(n=>({...n,...a}))},getGlobal:()=>t(),replaceGlobal:a=>{s(()=>({...a}))}}));async function B(){L(G()),W(),E(),await F(),sessionStorage.setItem("lze-web","true"),sessionStorage.getItem("app")=="true"?d.setState({locked:!1}):(d.setState({locked:!0}),Z()),sessionStorage.setItem("app","false");const s=U("home");d.setState({theme:s}),f()}function Z(){p.get({api:"login/auth_status",end:()=>{d.setState({load:d.getState().load+1})},fail:()=>{window.localStorage.setItem("username","guest"),window.localStorage.setItem("token",""),d.setState({load:d.getState().load+1}),j("guest"),w("")}})}function f(){const s=C();p.post({body:{user:s},api:"home/widget",success:t=>{d.setState({widgetData:t,load:d.getState().load+1})}})}async function $(){return atob(await A.get({api:"login/login"}))}async function b(s){let t=await $(),a=[];for(let n=0;n<s.length;n++)a.push(s.charCodeAt(n)^t.charCodeAt(n%t.length));return btoa(String.fromCharCode(...a))}function H({showItem:s,type:t,show:a}){return e.jsx("div",{className:"widget-panel "+(a?"widget-hide":""),children:s.map((n,o)=>e.jsxs(D.Fragment,{children:[t=="tra"&&e.jsx("li",{children:i("recent_delete")}),t=="bok"&&e.jsx("li",{children:i("recent_visit")}),e.jsx("div",{className:"widget-panel-item "+t+"-panel",title:i("view"),onClick:l=>{l.stopPropagation(),Y(t,n)},children:Q(n,t)})]},n+o))},t+"panel")}function Q(s,t){switch(t){case"pic":return X(s);case"mon":return V(s);default:return e.jsx("span",{className:"panel-text "+(s==""?"panel-text-null":""),children:s==""?i("empty"):s})}}function V(s){const t=s.split("/");switch(t[0]){case"per_num":return i(t[0])+":"+t[1];default:return i(t[0])+":"+(t[1]=="never"||t[1]=="none"?i(t[1]):t[1]+i(t[2]))}}function X(s){const t=window.location.origin+"/file/Pictures/"+s.name;return s.media=="img"?e.jsx("img",{src:t,alt:s.name}):s.media=="vid"?e.jsx("video",{src:t,controls:"controls"}):e.jsx("span",{className:"panel-text panel-text-null",children:i("empty")})}function Y(s,t){if(s=="tra"){x.normal(i("recent_delete")+":"+t);return}if(s=="mon"){const a=C();x.normal(i("current_user")+":"+a);return}(s!="pic"&&t!=""||s=="pic"&&t.name!="")&&d.setState({listWin:{type:s,name:t,status:!0}})}function ee({theme:s,item:t,to_next:a,widgetData:n}){const[o,l]=u.useState(!1);return e.jsx(e.Fragment,{children:e.jsxs("div",{id:t+"widget",className:"widget-item",title:i("enter")+":"+i(t),mode:s.mode,color:s.color[t],onClick:()=>a(t),children:[e.jsx("div",{className:"widget-icon "+(o?"widget-hide":""),children:e.jsx("div",{id:t+"-icon"})}),e.jsx(H,{showItem:n[t],type:t,show:!o}),e.jsx("div",{className:"show-panel btn "+(o?"show-panel-enable":""),title:i("show"),onClick:c=>{c.stopPropagation(),l(!o)}}),e.jsx("span",{className:"widget-title",mode:s.mode,color:s.color.home,children:i(t)})]},t)})}function se({tmpLoad:s}){const t=d(c=>c.locked),a=d(c=>c.widgetData),n=d(c=>c.theme),o=["doc","pic","tra","mon","not","bok"],l=[];for(let c=0;c<o.length;c+=2)l.push(o.slice(c,c+2));return e.jsx("div",{id:"widget",className:!t&&s?"widget-load":"",children:l.map((c,r)=>e.jsx("div",{className:"widget-line",children:c.map(m=>e.jsx(ee,{item:m,theme:n,to_next:te,widgetData:a},m))},`line${r}`))})}function te(s){window.location.href=s}function ne(){const s=M(o=>o.lang),[t,a]=u.useState(!1),n={system:i("system"),zh:"简体中文",en:"English"};return e.jsx(e.Fragment,{children:t?e.jsx("div",{id:"lang-list",onClick:()=>{},children:Object.entries(n).map(([o,l])=>e.jsx("div",{className:"lang-list-item "+(o===s.userSelect?"lang-select":""),onClick:async()=>{localStorage.setItem("lang",o),a(!1),L(await O())},children:e.jsx("span",{children:l})},o))}):e.jsxs("div",{id:"show-lang",title:i("switch"),onClick:()=>{a(!0)},children:[e.jsx("span",{children:n[s.userSelect]}),e.jsx("div",{})]})})}function ae(){const[s,t]=u.useState(!1),a=[{id:"cpu",name:i("cpu_usage")},{id:"mem",name:i("mem_usage")},{id:"disk",name:i("disk_usage")}],[n,o]=u.useState({cpu:{data:"",percent:"0%"},mem:{data:"",percent:"0%"},disk:{data:"",percent:"0%"},net:{up:"0.00MB",down:"0.00MB"}});return u.useEffect(()=>{const l=setInterval(()=>{p.get({api:"system/system",loading:!1,success:c=>{o({cpu:{data:"",percent:c.cpuPercent},mem:{data:c.memData,percent:c.memPercent},disk:{data:c.diskData,percent:c.diskPercent},net:{up:c.netUp,down:c.netDown}}),s||t(!0)}})},3e3);return()=>{clearInterval(l)}},[]),e.jsxs("div",{id:"sys-app",children:[s?null:e.jsx("div",{id:"sys-loadPage",children:e.jsx("div",{className:"loading"})}),a.map(l=>e.jsx(D.Fragment,{children:e.jsxs("div",{className:"sys-box",title:l.name,children:[e.jsxs("div",{id:l.id+"-bar",className:"sys-bar",children:[e.jsx("div",{id:l.id+"-icon",className:"sys-icon"}),e.jsx("div",{id:l.id+"-progress-bar",className:"sys-progress-bar",children:e.jsx("div",{className:"sys-progress",style:{width:n[l.id].percent}})}),e.jsx("span",{id:l.id+"-percent",className:"sys-percent",children:n[l.id].percent})]}),e.jsx("span",{className:"sys-data",children:n[l.id].data})]})},l.id)),e.jsxs("div",{id:"net-box",className:"sys-box",title:i("net_usage"),children:[e.jsx("span",{id:"net-icon",className:"sys-icon"}),e.jsx("div",{id:"net-up",className:"sys-icon"}),e.jsx("span",{id:"net-up-data",className:"sys-data",children:n.net.up}),e.jsx("div",{id:"net-down",className:"sys-icon"}),e.jsx("span",{id:"net-down-data",className:"sys-data",children:n.net.down})]})]})}function oe(){const s=d(r=>r.theme),[t,a]=u.useState("home"),n={system:i("system"),dark:i("dark_mode"),light:i("light_mode")},o=["default","green","blue","orange","yellow","pink","red"],l=()=>{const r=["system","dark","light"],h=(r.indexOf(s.userSelect)+1)%r.length;N("userSelect",r[h])},c=()=>{const r=["home","doc","pic","tra","mon","not","bok"],h=(r.indexOf(t)+1)%r.length;a(r[h])};return e.jsxs("div",{id:"theme-app",children:[e.jsx("div",{id:"mode-bar",children:e.jsxs("button",{id:"show-mode",className:"btn theme-btn",onClick:l,children:[e.jsx("span",{children:n[s.userSelect]}),e.jsx("div",{className:"switch-icon",id:"switch-mode",title:"切换模式"})]})}),e.jsx("div",{id:"page-bar",children:e.jsxs("button",{id:"show-page",className:"btn theme-btn",onClick:c,children:[e.jsx("span",{children:i(t)}),e.jsx("div",{id:"switch-page",className:"switch-icon",title:i("switch")})]})}),e.jsx("div",{id:"color-bar",children:o.map((r,m)=>e.jsx("div",{className:"color-btn "+(s.color[t]===r?"color-btn-enable":""),mode:s.mode,color:r,onClick:()=>N("color",{...s.color,[t]:r}),children:e.jsx("div",{})},m+r))})]})}function N(s,t){const n={...d.getState().theme,[s]:t};s==="userSelect"&&(t==="system"?n.mode=R():n.mode=t),K(n.mode,n.color.home),document.body.setAttribute("mode",n.mode),document.body.setAttribute("color",n.color.home),d.setState({theme:n}),localStorage.setItem("theme",JSON.stringify(n))}function ie({tmpLoad:s,setTmpLoad:t}){const a=d(g=>g.showBg),n=d(g=>g.setGlobal),o=d(g=>g.locked),[l,c]=u.useState(""),r=g=>{c(g),n({showBg:!0})},m=()=>{n({showBg:!1}),c("")},h=[{id:"lang",name:i("lang_setting")},{id:"theme",name:i("theme")},{id:"sys",name:i("monitor")},{id:"lock",name:i("login_manage")}];return e.jsxs(e.Fragment,{children:[a&&e.jsxs("div",{className:"app-win float-win",children:[e.jsx("button",{className:"btn",id:"close-win",title:i("close"),onClick:m}),l==="lang"&&e.jsx(ne,{}),l==="sys"&&e.jsx(ae,{}),l==="theme"&&e.jsx(oe,{})]}),e.jsx("div",{id:"dock",className:!o&&s?"dock-load":"",children:h.map(g=>e.jsx("div",{id:g.id,title:g.name,className:"dock-app",onClick:()=>{g.id=="lock"?(t(!1),setTimeout(()=>{n({locked:!0}),t(!0)},500)):r(g.id)},children:e.jsx("div",{id:g.id+"-icon",className:"dock-icon"})},g.id))})]})}function le(){const s=d(a=>a.listWin),t=d(a=>a.theme);return e.jsxs(I,{showBg:s.status,children:[e.jsx("div",{id:"close-back",onClick:()=>{d.setState({listWin:{type:"",name:"",status:!1,color:""}})}}),e.jsx("div",{className:"list-win",color:t.color[s.type],mode:t.mode,id:s.type+"-list",children:ce(s.type,s.name)})]})}function ce(s,t){switch(s){case"doc":return e.jsx(de,{name:t});case"pic":return e.jsx(re,{name:t});case"not":return e.jsx(ue,{name:t});case"bok":return e.jsx(ge,{name:t});default:return null}}function de({name:s}){const[t,a]=u.useState(!1),[n,o]=u.useState(null);return u.useEffect(()=>{k("doc/list",{file:s},o,a)},[]),e.jsx(e.Fragment,{children:t?n.type=="dir"?n.filelist.map((l,c)=>e.jsxs("div",{className:"dir-view",title:l[0],children:[e.jsx("div",{className:l[1]=="dir"||l[1]=="dir_link"?"dir-view-dir":"dir-view-file"}),e.jsx("span",{children:l[0]})]},c+l[0])):n.view?e.jsx("iframe",{className:"file-view",src:window.location.origin+"/"+n.url}):e.jsx("span",{children:i("not_support_type")}):e.jsx("div",{className:"loading"})})}function re({name:s}){const t=window.location.origin+"/file/Pictures/"+s.name;if(s.media=="vid")return e.jsx("video",{src:t,controls:"controls",className:"list-media"});if(s.media="img")return e.jsx("img",{src:t,alt:s.name,className:"list-media"})}function ue({name:s}){const[t,a]=u.useState(!1),[n,o]=u.useState("");return u.useEffect(()=>{k("not/getText",{name:s},o,a)},[]),t?e.jsx("code",{children:n}):e.jsx("div",{className:"loading"})}function ge({name:s}){const[t,a]=u.useState(!1),[n,o]=u.useState("");return u.useEffect(()=>{k("bok/get_url",{name:s},o,a)},[]),t?window.location.href=n:e.jsx("div",{className:"loading"})}function k(s,t,a,n,o){p.post({api:s,body:t,success:l=>{a(l),n(!0)}})}function me(){const s=d(n=>n.showBg),[t,a]=u.useState(!0);return e.jsxs(e.Fragment,{children:[e.jsx(I,{showBg:s}),e.jsx(se,{tmpLoad:t}),e.jsx(ie,{tmpLoad:t,setTmpLoad:a}),e.jsx(le,{})]})}function he({setTmpLoad:s}){return e.jsxs("button",{id:"unlock-btn",className:"btn lock-btn",onClick:()=>{s(!1),setTimeout(()=>{d.setState({locked:!1}),s(!0)},500)},children:[e.jsx("div",{}),e.jsx("span",{children:i("start")})]})}function pe(){const[s,t]=u.useState(!1),a=d(n=>n.load);return u.useEffect(()=>{a==2&&t(!1)},[a]),s?e.jsx("div",{className:"loading",id:"lock-loading",children:" "}):e.jsxs("button",{id:"load-btn",className:"btn lock-btn",onClick:()=>{t(!0),d.setState({load:0}),B()},children:[e.jsx("div",{}),e.jsx("span",{children:i("refresh")})]})}function xe(){const s=_(t=>t.request.username);return e.jsxs("button",{id:"logout-btn",className:"btn lock-btn "+(s=="guest"?"logout-disabled":""),onClick:()=>we(),children:[e.jsx("div",{}),e.jsx("span",{children:i("exit")})]})}async function we(){await q.normal(i("are_you_sure"))&&(localStorage.removeItem("token"),localStorage.removeItem("username"),j("guest"),w(""),f(),x.normal(i("logout")))}function je({prop:s}){return e.jsxs("div",{id:"btn-box",children:[e.jsx(pe,{}),e.jsx(he,{setTmpLoad:s}),e.jsx(xe,{})]})}function fe({setSwitch:s}){const t=_(a=>a.request.username);return e.jsxs("button",{className:"btn",id:"lock-user",title:i("switch"),onClick:()=>{s(!0)},children:[e.jsx("div",{id:"lock-profile"}),e.jsx("div",{id:"lock-switch"}),e.jsx("span",{children:t==""||t=="guest"?i("guest"):t})]})}function be({prop:s}){return e.jsxs(e.Fragment,{children:[e.jsx(fe,{setSwitch:s.switch}),e.jsx(je,{prop:s.unlock})]})}function v({loading:s,send:t}){return e.jsx(e.Fragment,{children:s?e.jsx("div",{className:"loading user-page-loading"}):e.jsx("button",{className:"btn user-page-send",title:i("start"),onClick:()=>t()})})}function ke({para:s}){const[t,a]=u.useState({userName:"",password:""}),n=o=>{const{name:l,value:c}=o.target;a(r=>({...r,[l]:c}))};return e.jsxs("div",{className:"user-opt-page-win",onKeyDown:o=>s.keyDown(o,()=>S(t.userName,t.password,s)),children:[e.jsx("input",{className:"user-page-input",type:"text",name:"userName",placeholder:i("username"),value:t.userName,onChange:n}),e.jsx("input",{className:"user-page-input",type:"password",name:"password",value:t.password,onChange:n,placeholder:i("password")}),s.loading?e.jsx("div",{className:"loading user-page-loading"}):e.jsx(v,{loading:s.loading,send:()=>S(t.userName,t.password,s)})]})}async function S(s,t,a){a.setLoading(!0);let n=JSON.stringify({name:s,password:t});p.post({api:"login/login",body:{userMes:await b(n)},success:o=>{window.localStorage.setItem("username",s),window.localStorage.setItem("token",o.token),j(s),w(o.token),f(),x.normal(i("login")+":"+s),a.afterSend()},fail:()=>{a.setLoading(!1)}})}function ve({para:s}){const[t,a]=u.useState({oldPassword:"",newPassword:""}),n=o=>{const{name:l,value:c}=o.target;a(r=>({...r,[l]:c}))};return e.jsxs("div",{className:"user-opt-page-win",onKeyDown:o=>s.keyDown(o,()=>y(t.oldPassword,t.newPassword,s)),children:[e.jsx("input",{className:"user-page-input",type:"password",name:"oldPassword",value:t.oldPassword,onChange:n,placeholder:i("old")+" "+i("password")}),e.jsx("input",{className:"user-page-input",type:"password",name:"newPassword",value:t.newPassword,onChange:n,placeholder:i("new")+" "+i("password")}),e.jsx(v,{loading:s.loading,send:()=>y(t.oldPassword,t.newPassword,s)})]})}async function y(s,t,a){const n=await b(JSON.stringify({oldPas:s,newPas:t}));a.setLoading(!0),p.post({api:"login/modPas",body:{userMes:n},notice:!0,success:o=>{w(o.token),localStorage.setItem("token",o.token),a.afterSend()},fail:()=>{a.setLoading(!1)}})}function Ne({para:s}){const[t,a]=u.useState({userName:"",password:""}),n=o=>{const{name:l,value:c}=o.target;a(r=>({...r,[l]:c}))};return e.jsxs("div",{className:"user-opt-page-win",onKeyDown:o=>s.keyDown(o,()=>P(t.userName,t.password,s)),children:[e.jsx("input",{className:"user-page-input",type:"text",name:"userName",placeholder:i("new")+" "+i("username"),value:t.userName,onChange:n}),e.jsx("input",{className:"user-page-input",type:"password",name:"password",value:t.password,onChange:n,placeholder:i("password")}),s.loading?e.jsx("div",{className:"loading user-page-loading"}):e.jsx(v,{loading:s.loading,send:()=>P(t.userName,t.password,s)})]})}async function P(s,t,a){d.getState().token;const o=await b(JSON.stringify({name:s,password:t}));a.setLoading(!0),p.post({api:"login/register",body:{userMes:o},notice:!0,success:()=>{a.afterSend()},fail:()=>{a.setLoading(!1)}})}function Se({setSwitch:s}){const[t,a]=u.useState(!1),[n,o]=u.useState("login"),c={keyDown:(m,h)=>{m.key==="Enter"&&(t||h())},setLoading:a,loading:t,afterSend:()=>ye(a,s)},r={login:e.jsx(ke,{para:c}),modPas:e.jsx(ve,{para:c}),reg:e.jsx(Ne,{para:c})};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"user-page-win",children:[e.jsx("button",{className:"btn user-page-back",title:i("back"),onClick:()=>{s(!1)}}),e.jsxs("div",{id:"user-page-btn-bar",children:[e.jsx("button",{disabled:n==="login",className:"btn user-page-btn",title:i("login"),id:"login-btn",onClick:()=>{o("login")}}),e.jsx("button",{disabled:n==="modPas",className:"btn user-page-btn",title:i("modPas"),id:"modPas-btn",onClick:()=>{o("modPas")}}),e.jsx("button",{disabled:n==="reg",className:"btn user-page-btn",title:i("reg"),id:"reg-btn",onClick:()=>{o("reg")}})]}),r[n]]})})}function ye(s,t){s(!1),t(!1)}function Pe(){const[s,t]=u.useState(!1),a=d(l=>l.locked),[n,o]=u.useState(!0);return e.jsxs("div",{id:"lock-page",className:a&&n?"lock-page-load":"",children:[e.jsx("div",{id:"head-bar",className:a&&n?"head-bar-load":"",children:e.jsx("div",{id:"head-name"})}),s?e.jsx(Se,{setSwitch:t}):e.jsx(be,{prop:{unlock:o,switch:t}})]})}function Le(){const s=d(t=>t.theme);return e.jsxs("div",{id:"app",color:s.color.home,mode:s.mode,children:[e.jsx(Pe,{}),e.jsx(me,{}),e.jsx("div",{className:"wallpaper"}),e.jsx(J,{})]})}B();z.createRoot(document.getElementById("root")).render(e.jsx(Le,{}));
