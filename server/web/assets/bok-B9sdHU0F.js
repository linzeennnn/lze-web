import{c as j,A as d,j as e,k as a,h as s,q as k,r as c,n as w,o as g,W as y,u as N,P as B,t as v}from"./all-0L4ytAmL.js";import{P as W,C as S,T as C,S as _,a as F,H as G,G as I,b as L}from"./page-B6_6T00P.js";import{F as P}from"./floatWin-CZJDpZqi.js";const l=j((t,o)=>({userName:window.localStorage.getItem("userName"),token:window.localStorage.getItem("token"),showBg:!1,loading:!1,langList:[],bokList:[],fileWin:!1,setGlobal:n=>{t(r=>({...r,...n}))},replaceGlobal:n=>{t(()=>({...n}))},getGlobal:()=>o()}));function T(){W("bok"),u()}function u(){d.get({api:"bok/list",success:t=>{l.setState({bokList:t})}})}function E({name:t}){return e.jsxs("div",{className:"bookmark main-item",title:s("view")+t,onClick:()=>{A(t)},children:[e.jsx("button",{className:"btn",id:"del-btn",title:s("delete"),onClick:o=>{o.stopPropagation(),D(t)},children:a("no")}),e.jsx("span",{children:t})]})}function A(t){d.post({api:"bok/get_url",body:{name:t},success:o=>{o.protocol=="doc"||o.protocol=="pic"||o.protocol=="not"?console.log(o):window.location.href=o.url}})}async function D(t){await k.normal(s("are_you_sure"))&&d.delete({api:"bok/del",body:{name:t},notice:!0,success:()=>{u()}})}function K(){const t=l(o=>o.bokList);return e.jsx(S,{children:t.map((o,n)=>e.jsx(E,{name:o},n+o))})}function R(){const t=[{type:"none",showName:s("no_protocol")},{type:"http",showName:"http://"},{type:"https",showName:"https://"},{type:"file",showName:"file://"}],o=i=>{i.key==="Enter"&&f(h,n(p))},n=i=>U(i)?i:r==0?"https://"+i:t[r].showName+i,[r,x]=c.useState(0),[h,m]=c.useState(""),[p,b]=c.useState("");return e.jsxs(C,{children:[e.jsxs("div",{id:"title-box",children:[e.jsx("input",{placeholder:s("bok_name"),onKeyDown:o,id:"tit-input",type:"text",value:h,onChange:i=>m(i.target.value)}),e.jsx("button",{id:"save-add",title:s("save"),className:"btn",onClick:()=>f(h,n(p)),children:a("save")})]}),e.jsxs("div",{id:"link-box",children:[e.jsx("button",{id:"switch-protocol",title:s("switch_protocol"),className:"btn",onClick:()=>{x(i=>(i+1)%t.length)},children:a("switch")}),e.jsx("span",{id:"show-protocol",children:t[r].showName}),e.jsx("input",{placeholder:s("bok_url"),id:"link-input",onKeyDown:o,type:"text",value:p,onChange:i=>b(i.target.value)})]})]})}function U(t){return!!(t.startsWith("http://")||t.startsWith("https://")||t.startsWith("file://"))}function f(t,o){if(t==""&&(t="new_bookmark"),!H(o)){w.err(s("bok_url")+" "+s("error")+" "+o);return}d.post({api:"bok/add",body:{name:t,text:o},notice:!0,success:()=>{u()}})}function H(t){try{return new URL(t).hostname.includes(".")}catch{return!1}}function M(){return e.jsx("button",{className:"btn side-btn",onClick:()=>{l.setState({fileWin:!0})},title:s("addFile"),children:a("addFile")})}function q(){const t=()=>{u()};return c.useEffect(()=>{g({refresh:{name:s("refresh"),fun:t}})},[]),e.jsx("button",{className:"btn side-btn",title:s("refresh"),onClick:t,children:a("load")})}function z(){return e.jsxs(_,{children:[e.jsx(M,{}),e.jsx(q,{})]})}function J(){const t=l(o=>o.fileWin);return e.jsx(P,{show:t,title:s("addFile"),setShow:()=>{l.setState({fileWin:!1})},children:e.jsx("div",{className:"file-win"})})}function O(){const t=l(n=>n.showBg),o=l(n=>n.loading);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"loading",id:"list-loading",style:o?{display:"block"}:{display:"none"}}),e.jsx(y,{showBg:t})]})}function Q(){return e.jsxs(e.Fragment,{children:[e.jsx(O,{}),e.jsx(J,{})]})}function V(){const t=N(o=>o.theme);return e.jsxs("div",{id:"app",mode:t.mode,color:t.color.bok,children:[e.jsx("div",{className:"wallpaper"}),e.jsxs(F,{children:[e.jsx(G,{}),e.jsx(R,{}),e.jsx(I,{}),e.jsx(L,{})]}),e.jsx(Q,{}),e.jsx(z,{}),e.jsx(K,{}),e.jsx(B,{})]})}T();v.createRoot(document.getElementById("root")).render(e.jsx(V,{}));
