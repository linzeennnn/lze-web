import{c as k,A as c,j as e,f as i,m as x,r as l,n as j,k as g,W as w,P as y,o as B}from"./all-D8KwLJwx.js";import{P as N,C as v,T as C,S,a as _,H as W,G,b as L}from"./page-BkcQCuwQ.js";const a=k((t,o)=>({userName:window.localStorage.getItem("userName"),token:window.localStorage.getItem("token"),showBg:!1,loading:!1,langList:[],bokList:[],bokUrl:`${window.location.origin}/server/bok/`,theme:{mode:"",color:{bok:""}},setGlobal:s=>{t(r=>({...r,...s}))},replaceGlobal:s=>{t(()=>({...s}))},getGlobal:()=>o()}));function P(){N(a.setState,"bok"),d()}function d(){c.get({api:"bok/list",success:t=>{a.setState({bokList:t})}})}function E({name:t}){return e.jsxs("div",{className:"bookmark main-item",title:i("view")+t,onClick:()=>{I(t)},children:[e.jsx("button",{className:"btn",id:"del-btn",title:i("delete"),onClick:o=>{o.stopPropagation(),T(t)}}),e.jsx("span",{children:t})]})}function I(t){c.post({api:"bok/get_url",body:{name:t},success:o=>{window.location.href=o}})}async function T(t){await x.normal(i("are_you_sure"))&&c.delete({api:"bok/del",body:{name:t},notice:!0,success:()=>{d()}})}function D(){const t=a(o=>o.bokList);return e.jsx(v,{children:t.map((o,s)=>e.jsx(E,{name:o},s+o))})}function A(){const t=[{type:"none",showName:i("no_protocol")},{type:"http",showName:"http://"},{type:"https",showName:"https://"},{type:"file",showName:"file://"}],o=n=>{n.key==="Enter"&&h(u,s(p))},s=n=>U(n)?n:r==0?"https://"+n:t[r].showName+n,[r,m]=l.useState(0),[u,b]=l.useState(""),[p,f]=l.useState("");return e.jsxs(C,{children:[e.jsxs("div",{id:"title-box",children:[e.jsx("input",{placeholder:i("bok_name"),onKeyDown:o,id:"tit-input",type:"text",value:u,onChange:n=>b(n.target.value)}),e.jsx("button",{id:"save-add",title:i("save"),className:"btn",onClick:()=>h(u,s(p))})]}),e.jsxs("div",{id:"link-box",children:[e.jsx("button",{id:"switch-protocol",title:i("switch_protocol"),className:"btn",onClick:()=>{m(n=>(n+1)%t.length)}}),e.jsx("span",{id:"show-protocol",children:t[r].showName}),e.jsx("input",{placeholder:i("bok_url"),id:"link-input",onKeyDown:o,type:"text",value:p,onChange:n=>f(n.target.value)})]})]})}function U(t){return!!(t.startsWith("http://")||t.startsWith("https://")||t.startsWith("file://"))}function h(t,o){if(t==""&&(t="new_bookmark"),!K(o)){j.err(i("bok_url")+" "+i("error")+" "+o);return}c.post({api:"bok/add",body:{name:t,text:o},notice:!0,success:()=>{d()}})}function K(t){try{return new URL(t).hostname.includes(".")}catch{return!1}}function R(){const t=()=>{d()};return l.useEffect(()=>{g({refresh:{name:i("refresh"),fun:t}})},[]),e.jsx(S,{children:e.jsx("button",{className:"btn side-btn",id:"load",title:i("refresh"),onClick:t})})}function F(){const t=a(s=>s.showBg),o=a(s=>s.loading);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"loading",id:"list-loading",style:o?{display:"block"}:{display:"none"}}),e.jsx(w,{showBg:t})]})}function H(){return e.jsx(e.Fragment,{children:e.jsx(F,{})})}function M(){const t=a(o=>o.theme);return e.jsxs("div",{id:"app",mode:t.mode,color:t.color.bok,children:[e.jsx("div",{className:"wallpaper"}),e.jsxs(_,{children:[e.jsx(W,{}),e.jsx(A,{}),e.jsx(G,{}),e.jsx(L,{})]}),e.jsx(H,{}),e.jsx(R,{}),e.jsx(D,{}),e.jsx(y,{})]})}P();B.createRoot(document.getElementById("root")).render(e.jsx(M,{}));
