import{c as k,A as d,j as e,k as l,h as i,q as j,r,n as g,o as w,W as y,u as B,P as N,t as v}from"./all-DWz_aFjb.js";import{P as S,C,T as _,S as W,a as G,H as I,G as L,b as P}from"./page-D4VYC8C6.js";const c=k((t,o)=>({userName:window.localStorage.getItem("userName"),token:window.localStorage.getItem("token"),showBg:!1,loading:!1,langList:[],bokList:[],setGlobal:s=>{t(a=>({...a,...s}))},replaceGlobal:s=>{t(()=>({...s}))},getGlobal:()=>o()}));function T(){S("bok"),u()}function u(){d.get({api:"bok/list",success:t=>{c.setState({bokList:t})}})}function E({name:t}){return e.jsxs("div",{className:"bookmark main-item",title:i("view")+t,onClick:()=>{D(t)},children:[e.jsx("button",{className:"btn",id:"del-btn",title:i("delete"),onClick:o=>{o.stopPropagation(),A(t)},children:l("no")}),e.jsx("span",{children:t})]})}function D(t){d.post({api:"bok/get_url",body:{name:t},success:o=>{window.location.href=o}})}async function A(t){await j.normal(i("are_you_sure"))&&d.delete({api:"bok/del",body:{name:t},notice:!0,success:()=>{u()}})}function K(){const t=c(o=>o.bokList);return e.jsx(C,{children:t.map((o,s)=>e.jsx(E,{name:o},s+o))})}function R(){const t=[{type:"none",showName:i("no_protocol")},{type:"http",showName:"http://"},{type:"https",showName:"https://"},{type:"file",showName:"file://"}],o=n=>{n.key==="Enter"&&f(h,s(p))},s=n=>U(n)?n:a==0?"https://"+n:t[a].showName+n,[a,m]=r.useState(0),[h,x]=r.useState(""),[p,b]=r.useState("");return e.jsxs(_,{children:[e.jsxs("div",{id:"title-box",children:[e.jsx("input",{placeholder:i("bok_name"),onKeyDown:o,id:"tit-input",type:"text",value:h,onChange:n=>x(n.target.value)}),e.jsx("button",{id:"save-add",title:i("save"),className:"btn",onClick:()=>f(h,s(p)),children:l("save")})]}),e.jsxs("div",{id:"link-box",children:[e.jsx("button",{id:"switch-protocol",title:i("switch_protocol"),className:"btn",onClick:()=>{m(n=>(n+1)%t.length)},children:l("switch")}),e.jsx("span",{id:"show-protocol",children:t[a].showName}),e.jsx("input",{placeholder:i("bok_url"),id:"link-input",onKeyDown:o,type:"text",value:p,onChange:n=>b(n.target.value)})]})]})}function U(t){return!!(t.startsWith("http://")||t.startsWith("https://")||t.startsWith("file://"))}function f(t,o){if(t==""&&(t="new_bookmark"),!F(o)){g.err(i("bok_url")+" "+i("error")+" "+o);return}d.post({api:"bok/add",body:{name:t,text:o},notice:!0,success:()=>{u()}})}function F(t){try{return new URL(t).hostname.includes(".")}catch{return!1}}function H(){const t=()=>{u()};return r.useEffect(()=>{w({refresh:{name:i("refresh"),fun:t}})},[]),e.jsx(W,{children:e.jsx("button",{className:"btn side-btn",title:i("refresh"),onClick:t,children:l("load")})})}function M(){const t=c(s=>s.showBg),o=c(s=>s.loading);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"loading",id:"list-loading",style:o?{display:"block"}:{display:"none"}}),e.jsx(y,{showBg:t})]})}function q(){return e.jsx(e.Fragment,{children:e.jsx(M,{})})}function z(){const t=B(o=>o.theme);return e.jsxs("div",{id:"app",mode:t.mode,color:t.color.bok,children:[e.jsx("div",{className:"wallpaper"}),e.jsxs(G,{children:[e.jsx(I,{}),e.jsx(R,{}),e.jsx(L,{}),e.jsx(P,{})]}),e.jsx(q,{}),e.jsx(H,{}),e.jsx(K,{}),e.jsx(N,{})]})}T();v.createRoot(document.getElementById("root")).render(e.jsx(z,{}));
