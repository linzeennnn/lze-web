import{c as E,A as b,j as e,h as n,q as C,r as l,k as h,n as N,o as k,W as T,f as I,u as U,P as _,t as G}from"./all-0L4ytAmL.js";import{P as A,C as O,T as W,S as D,a as F,H as M,G as P,b as K}from"./page-B6_6T00P.js";import{F as B}from"./floatWin-CZJDpZqi.js";const r=E((t,s)=>{const o=window.localStorage.getItem("userName"),c=window.localStorage.getItem("token");return{userName:o,token:c,nowuser:o?.trim()||"guest",showBg:!1,loading:!1,controlList:null,langList:[],userList:null,showCmd:!1,showLogout:!1,monUrl:`${window.location.origin}/server/mon/`,setGlobal:a=>{t(m=>({...m,...a}))},replaceGlobal:a=>{t(()=>({...a}))},getGlobal:()=>s()}});function R(){A("mon"),S()}function S(){b.get({api:"mon/list",success:t=>{r.setState({controlList:t.control,userList:t.user})}})}function J({keyName:t,Mes:s}){const o=r(c=>c.nowuser);return e.jsx("div",{className:"action-bar "+(s.user.includes(o)?"have-action":"no-action"),title:n("modify_permission"),onClick:()=>{H(t.control,t.action,o,s.user.includes(o)?"remove":"add")},children:n(s.name)})}async function H(t,s,o,c){let a=n(c);await C.normal(a+"?")&&b.patch({api:"mon/update_act",body:{control:t,action:s,name:o,change:c},notice:!0,success:()=>{S()}})}function q({keyName:t,Mes:s}){const[o,c]=l.useState(!1);return s?e.jsxs("div",{className:"control-bar main-item",children:[e.jsx("span",{className:"control-name",children:n(t)}),o?e.jsx("div",{className:"action-list",children:Object.entries(s.action).map(([a,m])=>e.jsx(J,{keyName:{control:t,action:a},Mes:m},t+a))}):null,e.jsx("button",{className:"btn show-action",title:n("show"),onClick:()=>{c(!o)},children:h("setting")})]}):null}function $(){const t=r(s=>s.controlList);return e.jsx(O,{children:t?Object.entries(t).map(([s,o])=>e.jsx(q,{keyName:s,Mes:o},s)):null})}function z({Mes:t}){const[s,o]=l.useState(!1),c=r(d=>d.userList),a=r(d=>d.nowuser),m=r.setState;return e.jsxs("div",{id:"user-box",children:[e.jsx("button",{className:"btn",title:n("view_user"),onClick:()=>{o(!0)},children:h("user")}),e.jsx("span",{id:"user-text",onClick:()=>{o(!0)},children:a}),s?e.jsxs(e.Fragment,{children:[e.jsx("div",{id:"user-list",children:Object.entries(c).map(([d])=>e.jsx("div",{className:"name-item",onClick:()=>{m({nowuser:d}),o(!1)},children:e.jsx("span",{children:d})},d+"nameList"))}),e.jsx("div",{id:"user-back",onClick:()=>{o(!1)}})]}):null]})}function Q(){const t={never:n("never"),h:n("hour"),d:n("day"),m:n("month"),y:n("year")},s=r(i=>i.userList),o=r(i=>i.nowuser),c=Object.keys(t),[a,m]=l.useState("h"),[d,j]=l.useState(!1),[p,f]=l.useState(""),g=()=>{const u=(c.indexOf(a)+1)%c.length;m(c[u])},v=i=>{const{value:u}=i.target;f(u)},L=i=>{i.key==="Enter"&&w(p,a)},w=(i,u)=>{let x;if(u=="never")x="never";else{if(!(i>=0)){N.err(n("not_correct"));return}x=i+u}j(!1),f(""),V(o,x)};return s?e.jsxs("div",{id:"time-box",children:[e.jsx("button",{className:"btn",title:n("mod_log_time"),onClick:()=>j(!d),children:h("time")}),d?e.jsxs(e.Fragment,{children:[e.jsxs("div",{id:"time-input-box",className:"time-text",children:[e.jsx("input",{id:"time-input",placeholder:n("num"),value:p,onChange:v,onKeyDown:L}),e.jsx("button",{className:"btn mini-btn",title:n("save"),onClick:()=>{w(p,a)},children:h("save")})]}),e.jsx("div",{id:"unit-box",children:e.jsxs("div",{id:"unit-text",children:[e.jsx("span",{children:t[a]}),e.jsx("button",{className:"btn mini-btn",title:n("switch"),onClick:g,children:h("switch")})]})})]}):e.jsx("span",{className:"time-text",id:"display-time",title:n("allow_login_time"),children:X(s[o].tokentime)+t[Y(s[o].tokentime)]})]}):null}function V(t,s){b.patch({api:"mon/date",body:{name:t,time:s},notice:!0,success:()=>[S()]})}function X(t){return t=="never"||t==""||!t?"":parseInt(t.slice(0,-1))}function Y(t){return t=="never"||t==""||!t?"never":t.slice(-1)}function Z(){const t=r(s=>s.userList);return e.jsxs(W,{children:[e.jsx(z,{Mes:t}),e.jsx(Q,{})]})}function ee(){const t=()=>{S()};return l.useEffect(()=>{k({load:{name:n("refresh"),fun:t}})},[]),e.jsx("button",{className:"btn side-btn",title:n("refresh"),onClick:t,children:h("load")})}function te(){const t=()=>{r.setState({showCmd:!0})};return l.useEffect(()=>{k({terminal:{name:n("terminal"),fun:t}})},[]),e.jsx("button",{className:"btn side-btn",title:n("terminal"),onClick:t,children:h("shell")})}function se(){const t=()=>{r.setState({showLogout:!0})};return l.useEffect(()=>{k({logout:{name:n("logout"),fun:t}})},[]),e.jsx("button",{className:"btn side-btn",title:n("logout"),onClick:t,children:h("delUser")})}function ne(){return e.jsxs(D,{children:[e.jsx(te,{}),e.jsx(se,{}),e.jsx(ee,{})]})}function oe(){const t=r(o=>o.showBg),s=r(o=>o.loading);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"loading",id:"list-loading",style:s?{display:"block"}:{display:"none"}}),e.jsx(T,{showBg:t})]})}function ie(){const t=r(i=>i.showCmd),[s,o]=l.useState("输出"),[c,a]=l.useState(""),[m,d]=l.useState(""),[j,p]=l.useState(""),[f,g]=l.useState([]);l.useEffect(()=>{g(JSON.parse(localStorage.getItem("cmdList"))||[])},[]);const v=(i,u)=>{if(m==""||j==""){N.normal(n("none"));return}d(""),p("");const x=[...f,{title:i,cmd:u}];g(x),localStorage.setItem("cmdList",JSON.stringify(x)),N.normal(n("op_com"))},L=async i=>{if(!await C.normal(n("are_you_sure")))return;const u=[...f.slice(0,i),...f.slice(i+1)];g(u),localStorage.setItem("cmdList",JSON.stringify(u))},w=i=>{i.key==="Enter"&&v(m,j)};return e.jsx(B,{title:n("terminal"),show:t,setShow:()=>{r.setState({showCmd:!1})},children:e.jsxs("div",{id:"cmd-box",children:[e.jsx("div",{id:"cus-cmd-box",children:f.map((i,u)=>e.jsxs("div",{className:"cmd-item",title:n("run"),onClick:()=>{a(i.cmd),y(i.cmd,o)},children:[e.jsx("button",{className:"del-cmd btn",title:n("delete"),onClick:x=>{x.stopPropagation(),L(u)},children:h("no")}),e.jsx("span",{className:"cmd-title",children:i.title}),e.jsx("span",{className:"cmd-cmd",children:i.cmd})]},u+i.cmd))}),e.jsxs("div",{id:"send-box",className:"cmd-widget",children:[e.jsx("input",{id:"input-cmd",value:c,placeholder:n("cmd"),onKeyDown:i=>{i.key==="Enter"&&y(c,o)},onChange:i=>a(i.target.value)}),e.jsx("pre",{id:"output-text",children:s}),e.jsx("button",{className:"btn",id:"send-cmd",title:n("run"),onClick:()=>{y(c,o)},children:h("toRight")})]}),e.jsxs("div",{id:"cus-cmd-input-bar",className:"cmd-widget",children:[e.jsx("input",{placeholder:n("cus_name"),className:"cmd-input",onKeyDown:w,value:m,onChange:i=>d(i.target.value)}),e.jsx("input",{placeholder:n("cmd"),className:"cmd-input",onKeyDown:w,value:j,onChange:i=>p(i.target.value)}),e.jsx("button",{className:"btn",id:"add-cmd",title:n("add"),onClick:()=>{v(m,j)},children:h("add")})]})]})})}async function y(t,s){await C.normal(n("run")+"?")&&b.post({api:"mon/cmd",body:{cmd:t},success:o=>{s(o)}})}function ce(){const[t,s]=l.useState([]),o=r(c=>c.showLogout);return l.useEffect(()=>{(async()=>{const a=await re();s(a)})()},[]),e.jsx(B,{title:n("logout"),show:o,setShow:()=>{r.setState({showLogout:!1})},children:e.jsx("div",{id:"user-list-box",children:t.map(c=>e.jsxs("div",{className:"user-item-box",children:[e.jsx("button",{className:"del-uaer-btn btn",title:n("delete"),onClick:()=>{ae(c,s)},children:h("no")}),e.jsx("span",{className:"user-showname",children:c})]},c+"-user-box"))})})}async function ae(t,s){await C.normal(n("are_you_sure"))&&b.delete({api:"mon/userList",body:{name:t},notice:!0,success:o=>{s(o)}})}async function re(){const t=await I.get({api:"mon/userList"});return t||[]}function le(){return e.jsxs(e.Fragment,{children:[e.jsx(ie,{}),e.jsx(ce,{}),e.jsx(oe,{})]})}function ue(){const t=U(s=>s.theme);return e.jsxs("div",{id:"app",mode:t.mode,color:t.color.mon,children:[e.jsxs(F,{children:[e.jsx(M,{}),e.jsx(Z,{}),e.jsx(P,{}),e.jsx(K,{})]}),e.jsx(le,{}),e.jsx(ne,{}),e.jsx($,{}),e.jsx(_,{}),e.jsx("div",{className:"wallpaper"})]})}R();G.createRoot(document.getElementById("root")).render(e.jsx(ue,{}));
