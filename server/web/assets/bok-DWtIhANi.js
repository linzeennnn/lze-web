import{c as x,A as l,j as e,f as i,l as f,r as p,n as j,W as g,P as w,m as y}from"./all-B5MRgsKL.js";import{P as B,C as N,T as v,S as C,a as S,H as _,G as W,b as G}from"./page-DHHrF6de.js";const a=x((t,o)=>({userName:window.localStorage.getItem("userName"),token:window.localStorage.getItem("token"),showBg:!1,loading:!1,langList:[],bokList:[],bokUrl:`${window.location.origin}/server/bok/`,theme:{mode:"",color:{bok:""}},setGlobal:s=>{t(r=>({...r,...s}))},replaceGlobal:s=>{t(()=>({...s}))},getGlobal:()=>o()}));function L(){B(a.setState,"bok"),c()}function c(){l.get({api:"bok/list",success:t=>{a.setState({bokList:t})}})}function P({name:t}){return e.jsxs("div",{className:"bookmark main-item",title:i("view")+t,onClick:()=>{I(t)},children:[e.jsx("button",{className:"btn",id:"del-btn",title:i("delete"),onClick:o=>{o.stopPropagation(),T(t)}}),e.jsx("span",{children:t})]})}function I(t){l.post({api:"bok/get_url",body:{name:t},success:o=>{window.location.href=o}})}async function T(t){await f.normal(i("are_you_sure"))&&l.delete({api:"bok/del",body:{name:t},notice:!0,success:()=>{c()}})}function D(){const t=a(o=>o.bokList);return e.jsx(N,{children:t.map((o,s)=>e.jsx(P,{name:o},s+o))})}function E(){const t=[{type:"none",showName:i("no_protocol")},{type:"http",showName:"http://"},{type:"https",showName:"https://"},{type:"file",showName:"file://"}],o=n=>{n.key==="Enter"&&h(d,s(u))},s=n=>U(n)?n:r==0?"https://"+n:t[r].showName+n,[r,b]=p.useState(0),[d,m]=p.useState(""),[u,k]=p.useState("");return e.jsxs(v,{children:[e.jsxs("div",{id:"title-box",children:[e.jsx("input",{placeholder:i("bok_name"),onKeyDown:o,id:"tit-input",type:"text",value:d,onChange:n=>m(n.target.value)}),e.jsx("button",{id:"save-add",title:i("save"),className:"btn",onClick:()=>h(d,s(u))})]}),e.jsxs("div",{id:"link-box",children:[e.jsx("button",{id:"switch-protocol",title:i("switch_protocol"),className:"btn",onClick:()=>{b(n=>(n+1)%t.length)}}),e.jsx("span",{id:"show-protocol",children:t[r].showName}),e.jsx("input",{placeholder:i("bok_url"),id:"link-input",onKeyDown:o,type:"text",value:u,onChange:n=>k(n.target.value)})]})]})}function U(t){return!!(t.startsWith("http://")||t.startsWith("https://")||t.startsWith("file://"))}function h(t,o){if(t==""&&(t="new_bookmark"),!A(o)){j.err(i("bok_url")+" "+i("error")+" "+o);return}l.post({api:"bok/add",body:{name:t,text:o},notice:!0,success:()=>{c()}})}function A(t){try{return new URL(t).hostname.includes(".")}catch{return!1}}function K(){return e.jsx(C,{children:e.jsx("button",{className:"btn side-btn",id:"load",title:i("refresh"),onClick:()=>{c()}})})}function R(){const t=a(s=>s.showBg),o=a(s=>s.loading);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"loading",id:"list-loading",style:o?{display:"block"}:{display:"none"}}),e.jsx(g,{showBg:t})]})}function F(){return e.jsx(e.Fragment,{children:e.jsx(R,{})})}function H(){const t=a(o=>o.theme);return e.jsxs("div",{id:"app",mode:t.mode,color:t.color.bok,children:[e.jsx("div",{className:"wallpaper"}),e.jsxs(S,{children:[e.jsx(_,{}),e.jsx(E,{}),e.jsx(W,{}),e.jsx(G,{})]}),e.jsx(F,{}),e.jsx(K,{}),e.jsx(D,{}),e.jsx(w,{})]})}L();y.createRoot(document.getElementById("root")).render(e.jsx(H,{}));
