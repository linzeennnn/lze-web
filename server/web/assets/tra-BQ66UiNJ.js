import{c as u,A as d,j as e,f as i,n as h,r as p,W as x,P as j,m}from"./all-B5MRgsKL.js";import{P as w,C as g,T as f,S as b,a as P,H as k,G as _,b as B}from"./page-DHHrF6de.js";const a=u((t,n)=>({userName:window.localStorage.getItem("userName"),token:window.localStorage.getItem("token"),nowPath:"",parentPath:"",fileList:[],uploading:!1,showBg:!1,loading:!1,selected:[],source_path:!0,theme:{mode:"",color:{tra:""},userSelect:""},setGlobal:o=>{t(r=>({...r,...o}))},replaceGlobal:o=>{t(()=>({...o}))},getGlobal:()=>n()}));function C(){w(a.setState,"tra"),l("")}function l(t){d.post({api:"tra/list",body:{folder:t},success:n=>{S(!1);let o;n.currentFolder==""?o=!0:o=!1,a.setState({fileList:n.filelist,nowPath:n.currentFolder,parentPath:n.parentFolder,source_path:o,selected:[]})}})}function S(t){a.setState({loading:t,showBg:t})}function G({fileMes:t}){const n=a(o=>o.nowPath);return e.jsxs(e.Fragment,{children:[e.jsx("span",{className:(t[1]==="dir"||t[1]==="dir_link"?"dir-text":"file-text")+" file-list-text",title:i("view")+t[0],onClick:o=>{if(o.stopPropagation(),t[1]==="dir"||t[1]==="dir_link"){const r=n+"/"+t[0];l(r)}if(t[1]==="file"||t[1]==="file_link"){const r=n+"/"+t[0];window.location.href=window.location.origin+"/file/trash"+r}},children:t[0]}),e.jsx("span",{className:"ori-path",title:i("ori_path")+":"+t[2]==""?"/":t[2],children:t[2]==""?"/":t[2]})]})}function N({fileMes:t,selected:n,traClick:o}){const s=a.getState().nowPath+"/"+t[0];return e.jsx("div",{className:`tra-list main-item ${n.includes(s)?"tra-list-selected":""}`,onClick:()=>o(s),children:e.jsx(G,{fileMes:t})},"tralist"+t[0])}function v(){const t=s=>{let c=[...o];c.includes(s)?(c.splice(c.indexOf(s),1),h.normal(i("cancel"))):(c.push(s),h.normal(i("selected")+c.length+i("file"))),r({selected:c})},n=a(s=>s.fileList),o=a(s=>s.selected),r=a(s=>s.setGlobal);return e.jsx(g,{children:n.map((s,c)=>e.jsx(N,{fileMes:s,selected:o,traClick:t},"tralist"+s[0]+c))})}function T(){const t=a(r=>r.nowPath),n=a(r=>r.parentPath),o=t==="/"||t==="";return e.jsx("button",{id:"go-up",className:(o?"go-up-disable":"")+" btn top-bar-widget",disabled:o,title:o?"":i("back"),onClick:()=>{o||l(n)}})}function y(){const t=a(n=>n.nowPath);return e.jsx("div",{id:"show-path",title:t,children:e.jsx("span",{children:t})})}function F(){const t=a(n=>n.nowPath);return e.jsx("button",{className:"btn top-bar-widget",id:"go-home",onClick:()=>{t!=""&&l("")},title:i("back_main_dir")})}function I(){const[t,n]=p.useState(!1);return e.jsxs(f,{children:[e.jsx(T,{}),e.jsx(y,{}),e.jsx(F,{})]})}function L(){const t=a(n=>n.nowPath);return e.jsx("button",{className:"btn  side-btn",id:"load",title:i("refresh"),onClick:()=>{l(t)}})}function W(){const t=a(o=>o.nowPath),n=async()=>{d.delete({api:"tra/del",notice:!0,end:()=>{l(t)}})};return e.jsx("button",{id:"del",className:"btn side-btn",onClick:()=>{n()},title:i("clear_tra")})}function E(){const t=a(s=>s.selected),n=a(s=>s.source_path),o=a(s=>s.nowPath),r=async()=>{d.post({api:"tra/recover",body:{recover_list:t,source_path:n},notice:!0,end:()=>{l(o)}})};return e.jsx("button",{className:"btn side-btn",id:"recover",title:i("restore"),onClick:()=>{r()}})}function R(){return e.jsxs(b,{children:[e.jsx(L,{}),e.jsx(W,{}),e.jsx(E,{})]})}function A(){const t=a(o=>o.showBg),n=a(o=>o.loading);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"loading",id:"list-loading",style:n?{display:"block"}:{display:"none"}}),e.jsx(x,{showBg:t})]})}function H(){return e.jsx(e.Fragment,{children:e.jsx(A,{})})}function D(){const t=a(n=>n.theme);return e.jsxs("div",{id:"app",mode:t.mode,color:t.color.tra,children:[e.jsx("div",{className:"wallpaper"}),e.jsxs(P,{children:[e.jsx(k,{}),e.jsx(_,{}),e.jsx(B,{}),e.jsx(I,{}),e.jsx(R,{}),e.jsx(v,{}),e.jsx(H,{})]}),e.jsx(j,{})]})}C();m.createRoot(document.getElementById("root")).render(e.jsx(D,{}));
