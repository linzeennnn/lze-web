import{c as b,A as c,j as e,h as i,p as k,r,n as j,m as g,W as w,u as y,P as B,q as N}from"./all-BVWShXoU.js";import{P as v,C as S,T as C,S as _,a as W,H as G,G as L,b as I}from"./page-BNzuI8qS.js";const l=b((t,o)=>({userName:window.localStorage.getItem("userName"),token:window.localStorage.getItem("token"),showBg:!1,loading:!1,langList:[],bokList:[],setGlobal:s=>{t(a=>({...a,...s}))},replaceGlobal:s=>{t(()=>({...s}))},getGlobal:()=>o()}));function P(){v("bok"),d()}function d(){c.get({api:"bok/list",success:t=>{l.setState({bokList:t})}})}function T({name:t}){return e.jsxs("div",{className:"bookmark main-item",title:i("view")+t,onClick:()=>{E(t)},children:[e.jsx("button",{className:"btn",id:"del-btn",title:i("delete"),onClick:o=>{o.stopPropagation(),D(t)}}),e.jsx("span",{children:t})]})}function E(t){c.post({api:"bok/get_url",body:{name:t},success:o=>{window.location.href=o}})}async function D(t){await k.normal(i("are_you_sure"))&&c.delete({api:"bok/del",body:{name:t},notice:!0,success:()=>{d()}})}function A(){const t=l(o=>o.bokList);return e.jsx(S,{children:t.map((o,s)=>e.jsx(T,{name:o},s+o))})}function K(){const t=[{type:"none",showName:i("no_protocol")},{type:"http",showName:"http://"},{type:"https",showName:"https://"},{type:"file",showName:"file://"}],o=n=>{n.key==="Enter"&&h(u,s(p))},s=n=>R(n)?n:a==0?"https://"+n:t[a].showName+n,[a,f]=r.useState(0),[u,m]=r.useState(""),[p,x]=r.useState("");return e.jsxs(C,{children:[e.jsxs("div",{id:"title-box",children:[e.jsx("input",{placeholder:i("bok_name"),onKeyDown:o,id:"tit-input",type:"text",value:u,onChange:n=>m(n.target.value)}),e.jsx("button",{id:"save-add",title:i("save"),className:"btn",onClick:()=>h(u,s(p))})]}),e.jsxs("div",{id:"link-box",children:[e.jsx("button",{id:"switch-protocol",title:i("switch_protocol"),className:"btn",onClick:()=>{f(n=>(n+1)%t.length)}}),e.jsx("span",{id:"show-protocol",children:t[a].showName}),e.jsx("input",{placeholder:i("bok_url"),id:"link-input",onKeyDown:o,type:"text",value:p,onChange:n=>x(n.target.value)})]})]})}function R(t){return!!(t.startsWith("http://")||t.startsWith("https://")||t.startsWith("file://"))}function h(t,o){if(t==""&&(t="new_bookmark"),!U(o)){j.err(i("bok_url")+" "+i("error")+" "+o);return}c.post({api:"bok/add",body:{name:t,text:o},notice:!0,success:()=>{d()}})}function U(t){try{return new URL(t).hostname.includes(".")}catch{return!1}}function F(){const t=()=>{d()};return r.useEffect(()=>{g({refresh:{name:i("refresh"),fun:t}})},[]),e.jsx(_,{children:e.jsx("button",{className:"btn side-btn",id:"load",title:i("refresh"),onClick:t})})}function H(){const t=l(s=>s.showBg),o=l(s=>s.loading);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"loading",id:"list-loading",style:o?{display:"block"}:{display:"none"}}),e.jsx(w,{showBg:t})]})}function M(){return e.jsx(e.Fragment,{children:e.jsx(H,{})})}function q(){const t=y(o=>o.theme);return e.jsxs("div",{id:"app",mode:t.mode,color:t.color.bok,children:[e.jsx("div",{className:"wallpaper"}),e.jsxs(W,{children:[e.jsx(G,{}),e.jsx(K,{}),e.jsx(L,{}),e.jsx(I,{})]}),e.jsx(M,{}),e.jsx(F,{}),e.jsx(A,{}),e.jsx(B,{})]})}P();N.createRoot(document.getElementById("root")).render(e.jsx(q,{}));
