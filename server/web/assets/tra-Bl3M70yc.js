import{c as m,A as h,j as e,f as r,n as p,r as d,k as u,m as f,W as x,P as g,o as j}from"./all-DInseniR.js";import{P as w,C as b,T as P,S as _,a as k,H as S,G as B,b as C}from"./page-DpHUloXd.js";const s=m((t,n)=>({userName:window.localStorage.getItem("userName"),token:window.localStorage.getItem("token"),nowPath:"",parentPath:"",fileList:[],uploading:!1,showBg:!1,loading:!1,selected:[],source_path:!0,theme:{mode:"",color:{tra:""},userSelect:""},setGlobal:o=>{t(i=>({...i,...o}))},replaceGlobal:o=>{t(()=>({...o}))},getGlobal:()=>n()}));function v(){w(s.setState,"tra"),l("")}function l(t){h.post({api:"tra/list",body:{folder:t},success:n=>{G(!1);let o;n.currentFolder==""?o=!0:o=!1,s.setState({fileList:n.filelist,nowPath:n.currentFolder,parentPath:n.parentFolder,source_path:o,selected:[]})}})}function G(t){s.setState({loading:t,showBg:t})}function N({fileMes:t}){const n=s(o=>o.nowPath);return e.jsxs(e.Fragment,{children:[e.jsx("span",{className:(t[1]==="dir"||t[1]==="dir_link"?"dir-text":"file-text")+" file-list-text",title:r("view")+t[0],onClick:o=>{if(o.stopPropagation(),t[1]==="dir"||t[1]==="dir_link"){const i=n+"/"+t[0];l(i)}if(t[1]==="file"||t[1]==="file_link"){const i=n+"/"+t[0];window.location.href=window.location.origin+"/file/trash"+i}},children:t[0]}),e.jsx("span",{className:"ori-path",title:r("ori_path")+":"+t[2]==""?"/":t[2],children:t[2]==""?"/":t[2]})]})}function y({fileMes:t,selected:n,traClick:o}){const a=s.getState().nowPath+"/"+t[0];return e.jsx("div",{className:`tra-list main-item ${n.includes(a)?"tra-list-selected":""}`,onClick:()=>o(a),children:e.jsx(N,{fileMes:t})},"tralist"+t[0])}function T(){const t=a=>{let c=[...o];c.includes(a)?(c.splice(c.indexOf(a),1),p.normal(r("cancel"))):(c.push(a),p.normal(r("selected")+c.length+r("file"))),i({selected:c})},n=s(a=>a.fileList),o=s(a=>a.selected),i=s(a=>a.setGlobal);return e.jsx(b,{children:n.map((a,c)=>e.jsx(y,{fileMes:a,selected:o,traClick:t},"tralist"+a[0]+c))})}function E(){const t=s(a=>a.nowPath),n=s(a=>a.parentPath),o=t==="/"||t==="",i=()=>{o||l(n)};return d.useEffect(()=>{u({goUp:{name:r("back"),fun:i,disable:o}})},[o,n]),e.jsx("button",{id:"go-up",className:(o?"go-up-disable":"")+" btn top-bar-widget",disabled:o,title:o?"":r("back"),onClick:i})}function F(){const t=s(n=>n.nowPath);return e.jsx("div",{id:"show-path",title:t,children:e.jsx("span",{children:t})})}function W(){const t=s(o=>o.nowPath),n=()=>{t!=""&&l("")};return d.useEffect(()=>{u({goHome:{name:r("back_main_dir"),fun:n,disable:t==""}})},[t]),e.jsx("button",{className:"btn top-bar-widget",id:"go-home",onClick:n,title:r("back_main_dir")})}function H(){const[t,n]=d.useState(!1);return e.jsxs(P,{children:[e.jsx(E,{}),e.jsx(F,{}),e.jsx(W,{})]})}function I(){const t=s(o=>o.nowPath),n=()=>{l(t)};return d.useEffect(()=>{u({load:{name:r("refresh"),fun:n}})},[t]),e.jsx("button",{className:"btn side-btn",id:"load",title:r("refresh"),onClick:n})}function L(){const t=s(o=>o.nowPath),n=async()=>{await f.normal(r("are_you_sure"))&&h.delete({api:"tra/del",notice:!0,end:()=>{l(t)}})};return d.useEffect(()=>{u({clear:{name:r("clear_tra"),fun:n}})},[]),e.jsx("button",{id:"del",className:"btn side-btn",onClick:n,title:r("clear_tra")})}function A(){const t=async()=>{const n=s.getState(),o=n.selected,i=n.source_path,a=n.nowPath;await f.normal(r("are_you_sure"))&&h.post({api:"tra/recover",body:{recover_list:o,source_path:i},notice:!0,end:()=>{l(a)}})};return d.useEffect(()=>{u({recover:{name:r("restore"),fun:t}})},[]),e.jsx("button",{className:"btn side-btn",id:"recover",title:r("restore"),onClick:t})}function R(){return e.jsxs(_,{children:[e.jsx(I,{}),e.jsx(L,{}),e.jsx(A,{})]})}function U(){const t=s(o=>o.showBg),n=s(o=>o.loading);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"loading",id:"list-loading",style:n?{display:"block"}:{display:"none"}}),e.jsx(x,{showBg:t})]})}function D(){return e.jsx(e.Fragment,{children:e.jsx(U,{})})}function O(){const t=s(n=>n.theme);return e.jsxs("div",{id:"app",mode:t.mode,color:t.color.tra,children:[e.jsx("div",{className:"wallpaper"}),e.jsxs(k,{children:[e.jsx(S,{}),e.jsx(B,{}),e.jsx(C,{}),e.jsx(H,{}),e.jsx(R,{}),e.jsx(T,{}),e.jsx(D,{})]}),e.jsx(g,{})]})}v();j.createRoot(document.getElementById("root")).render(e.jsx(O,{}));
