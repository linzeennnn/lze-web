import{c as b,j as e,n as c,r as d,W as j,T as x,b as w}from"./all-C9ceoJJ-.js";import{P as S,C as y,T as N,S as B,a as T,H as v,G as C,b as _}from"./page-lQh4YlDb.js";const a=b((t,o)=>({userName:window.localStorage.getItem("userName"),token:window.localStorage.getItem("token"),showBg:!1,loading:!1,langList:[],bokList:[],bokUrl:`${window.location.origin}/server/bok/`,theme:{mode:"",color:{bok:""}},setGlobal:n=>{t(i=>({...i,...n}))},replaceGlobal:n=>{t(()=>({...n}))},getGlobal:()=>o()}));function s(t){return a.getState().langList[t]}function G(){S(a.setState,"bok"),h()}function h(){l(!0);const t=a.getState().bokUrl+"list";a.getState().edit,fetch(t,{method:"GET",headers:{"Content-Type":"application/json"}}).then(o=>o.json()).then(o=>{a.setState({bokList:o}),l(!1)})}function l(t){a.setState({loading:t,showBg:t})}function P({name:t}){return e.jsxs("div",{className:"bookmark main-item",title:s("view")+t,onClick:()=>{L(t)},children:[e.jsx("button",{className:"btn",id:"del-btn",title:s("delete"),onClick:o=>{o.stopPropagation(),U(t)}}),e.jsx("span",{children:t})]})}function L(t){l(!0);const o=a.getState().bokUrl+"get_url";fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t})}).then(n=>{if(!n.ok){c(+s("error")+":"+n.status),l(!1);return}return n.text()}).then(n=>{l(!1),window.location.href=n})}function U(t){if(!confirm(s("are_you_sure")))return;l(!0),a.getState().userName;const o=a.getState().token,n=a.getState().bokUrl+"del";fetch(n,{method:"POST",headers:{"Content-Type":"application/json",authorization:"Bearer "+o},body:JSON.stringify({name:t})}).then(i=>{if(!i.ok){i.status===401?c(s("no_per")):c(s("error")+":"+i.status),l(!1);return}c(s("op_com")),h()})}function E(){const t=a(o=>o.bokList);return e.jsx(y,{children:t.map((o,n)=>e.jsx(P,{name:o},n+o))})}function W(){const t=[{type:"none",showName:s("no_protocol")},{type:"http",showName:"http://"},{type:"https",showName:"https://"},{type:"file",showName:"file://"}],o=r=>{r.key==="Enter"&&k(u,n(f))},n=r=>I(r)?r:i==0?"https://"+r:t[i].showName+r,[i,p]=d.useState(0),[u,m]=d.useState(""),[f,g]=d.useState("");return e.jsxs(N,{children:[e.jsxs("div",{id:"title-box",children:[e.jsx("input",{placeholder:s("bok_name"),onKeyDown:o,id:"tit-input",type:"text",value:u,onChange:r=>m(r.target.value)}),e.jsx("button",{id:"save-add",title:s("save"),className:"btn",onClick:()=>k(u,n(f))})]}),e.jsxs("div",{id:"link-box",children:[e.jsx("button",{id:"switch-protocol",title:s("switch_protocol"),className:"btn",onClick:()=>{p(r=>(r+1)%t.length)}}),e.jsx("span",{id:"show-protocol",children:t[i].showName}),e.jsx("input",{placeholder:s("bok_url"),id:"link-input",onKeyDown:o,type:"text",value:f,onChange:r=>g(r.target.value)})]})]})}function I(t){return!!(t.startsWith("http://")||t.startsWith("https://")||t.startsWith("file://"))}function k(t,o){if(t==""&&(t="new_bookmark"),!O(o)){c(s("bok_url")+" "+s("error")+" "+o),console.log(o);return}l(!0),a.getState().userName;const n=a.getState().token,i=a.getState().bokUrl+"add",p={name:t,text:o};fetch(i,{method:"POST",headers:{"Content-Type":"application/json",authorization:"Bearer "+n},body:JSON.stringify(p)}).then(u=>{if(!u.ok){u.status===401?c(s("no_per")):c(s("error")+":"+u.status),l(!1);return}c(s("op_com")),h()})}function O(t){try{return new URL(t).hostname.includes(".")}catch{return!1}}function D(){return e.jsx(B,{children:e.jsx("button",{className:"btn side-btn",id:"load",title:s("refresh"),onClick:()=>{h()}})})}function J(){const t=a(n=>n.showBg),o=a(n=>n.loading);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"loading",id:"list-loading",style:o?{display:"block"}:{display:"none"}}),e.jsx(j,{showBg:t})]})}function K(){return e.jsx(e.Fragment,{children:e.jsx(J,{})})}function R(){const t=a(o=>o.theme);return d.useEffect(()=>{G()},[]),e.jsxs("div",{id:"app",mode:t.mode,color:t.color.bok,children:[e.jsx("div",{className:"wallpaper"}),e.jsxs(T,{children:[e.jsx(v,{}),e.jsx(W,{}),e.jsx(C,{}),e.jsx(_,{})]}),e.jsx(K,{}),e.jsx(D,{}),e.jsx(E,{}),e.jsx(x,{})]})}w.createRoot(document.getElementById("root")).render(e.jsx(R,{}));
