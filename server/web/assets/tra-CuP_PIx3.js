import{c as m,j as e,n as d,r as x,W as j,T as g,b as w}from"./all-Dn0koDWs.js";import{P as b,C as P,T as _,S as k,a as S,H as T,G as N,b as y}from"./page-Co_x18R4.js";const s=m((t,n)=>({userName:window.localStorage.getItem("userName"),token:window.localStorage.getItem("token"),nowPath:"",parentPath:"",fileList:[],uploading:!1,showBg:!1,loading:!1,langList:[],selected:[],source_path:!0,theme:{mode:"",color:{tra:""},userSelect:""},traUrl:`${window.location.origin}/server/tra/`,setGlobal:o=>{t(a=>({...a,...o}))},replaceGlobal:o=>{t(()=>({...o}))},getGlobal:()=>n()}));function c(t){return s.getState().langList[t]}function C(){b(s.setState,"tra"),u("")}function u(t){const n={folder:t},o=s.getState().traUrl;h(!0),fetch(`${o}list`,{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).then(a=>a.json()).then(a=>{h(!1);let r;a.currentFolder==""?r=!0:r=!1,s.setState({fileList:a.filelist,nowPath:a.currentFolder,parentPath:a.parentFolder,source_path:r,selected:[]})})}function h(t){s.setState({loading:t,showBg:t})}function B({fileMes:t}){const n=s(o=>o.nowPath);return e.jsxs(e.Fragment,{children:[e.jsx("span",{className:(t[1]==="dir"||t[1]==="dir_link"?"dir-text":"file-text")+" file-list-text",title:c("view")+t[0],onClick:o=>{if(o.stopPropagation(),t[1]==="dir"||t[1]==="dir_link"){const a=n+"/"+t[0];u(a)}if(t[1]==="file"||t[1]==="file_link"){const a=n+"/"+t[0];window.location.href=window.location.origin+"/file/trash"+a}},children:t[0]}),e.jsx("span",{className:"ori-path",title:c("ori_path")+":"+t[2]==""?"/":t[2],children:t[2]==""?"/":t[2]})]})}function v({fileMes:t,selected:n,traClick:o}){const r=s.getState().nowPath+"/"+t[0];return e.jsx("div",{className:`tra-list main-item ${n.includes(r)?"tra-list-selected":""}`,onClick:()=>o(r),children:e.jsx(B,{fileMes:t})},"tralist"+t[0])}function G(){const t=r=>{let i=[...o];i.includes(r)?(i.splice(i.indexOf(r),1),d(c("cancel"))):(i.push(r),d(c("selected")+i.length+c("file"))),a({selected:i})},n=s(r=>r.fileList),o=s(r=>r.selected),a=s(r=>r.setGlobal);return e.jsx(P,{children:n.map((r,i)=>e.jsx(v,{fileMes:r,selected:o,traClick:t},"tralist"+r[0]+i))})}function F(){const t=s(a=>a.nowPath),n=s(a=>a.parentPath),o=t==="/"||t==="";return e.jsx("button",{id:"go-up",className:(o?"go-up-disable":"")+" btn top-bar-widget",disabled:o,title:o?"":c("back"),onClick:()=>{o||u(n)}})}function L(){const t=s(n=>n.nowPath);return e.jsx("div",{id:"show-path",title:t,children:e.jsx("span",{children:t})})}function O(){const t=s(n=>n.nowPath);return e.jsx("button",{className:"btn top-bar-widget",id:"go-home",onClick:()=>{t!=""&&u("")},title:c("back_main_dir")})}function E(){const[t,n]=x.useState(!1);return e.jsxs(_,{children:[e.jsx(F,{}),e.jsx(L,{}),e.jsx(O,{})]})}function I(){const t=s(n=>n.nowPath);return e.jsx("button",{className:"btn  side-btn",id:"load",title:c("refresh"),onClick:()=>{u(t)}})}function U(){const t=s(i=>i.userName),n=s(i=>i.token),o=s(i=>i.nowPath),a=s(i=>i.traUrl)+"del",r=()=>{if(!confirm(c("are_you_sure")))return;h(!0),fetch(a,{method:"POST",body:JSON.stringify({user:t,token:n}),headers:{"Content-Type":"application/json",authorization:"Bearer "+n,"x-user":t}}).then(p=>{if(!p.ok){p.status==401?d(c("no_per")):d(c("error")+":"+p.status),h(!1);return}d(c("op_com")),u(o)})};return e.jsx("button",{id:"del",className:"btn side-btn",onClick:()=>{r()},title:c("clear_tra")})}function R(){const t=s(l=>l.userName),n=s(l=>l.token),o=s(l=>l.selected),a=s(l=>l.source_path),r=s(l=>l.nowPath),i=s(l=>l.traUrl)+"recover",p=()=>{if(o.length==0){d(c("no_select_file"));return}if(!confirm(c("are_you_sure")))return;h(!0),fetch(i,{method:"POST",body:JSON.stringify({user:t,token:n,recover_list:o,source_path:a}),headers:{"Content-Type":"application/json",authorization:"Bearer "+n,"x-user":t}}).then(f=>{if(!f.ok){f.status==401?d(c("no_per")):d(c("error")+":"+f.status),h(!1);return}d(c("op_com")),u(r)})};return e.jsx("button",{className:"btn side-btn",id:"recover",title:c("restore"),onClick:()=>{p()}})}function W(){return e.jsxs(k,{children:[e.jsx(I,{}),e.jsx(U,{}),e.jsx(R,{})]})}function D(){const t=s(o=>o.showBg),n=s(o=>o.loading);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"loading",id:"list-loading",style:n?{display:"block"}:{display:"none"}}),e.jsx(j,{showBg:t})]})}function H(){return e.jsx(e.Fragment,{children:e.jsx(D,{})})}function J(){const t=s(n=>n.theme);return x.useEffect(()=>{C()},[]),e.jsxs("div",{id:"app",mode:t.mode,color:t.color.tra,children:[e.jsx("div",{className:"wallpaper"}),e.jsxs(S,{children:[e.jsx(T,{}),e.jsx(N,{}),e.jsx(y,{}),e.jsx(E,{}),e.jsx(W,{}),e.jsx(G,{}),e.jsx(H,{})]}),e.jsx(g,{})]})}w.createRoot(document.getElementById("root")).render(e.jsx(J,{}));
