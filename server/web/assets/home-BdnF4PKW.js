import{c as W,s as B,G as O,I as q,D as K,C as J,a as z,b as $,A as x,d as S,e as k,g as A,f as Z,j as e,R as G,h as i,n as f,i as H,S as Q,r as u,F as b,k as m,u as w,l as U,m as V,o as X,W as Y,p as E,q as ee,P as se,t as te}from"./all-DWz_aFjb.js";import{P as M}from"./page-C3qsDjGe.js";const d=W((t,s)=>(window.localStorage.getItem("userName"),window.localStorage.getItem("token"),{load:0,showBg:!1,locked:!0,listWin:{type:"",name:"",status:!1},widgetData:{doc:[],pic:[],tra:[],mon:[],not:[],bok:[]},setGlobal:n=>{t(a=>({...a,...n}))},getGlobal:()=>s(),replaceGlobal:n=>{t(()=>({...n}))}}));async function F(){B(O()),q(),K(),await J(),z(),sessionStorage.setItem("lze-web","true"),sessionStorage.getItem("app")=="true"?d.setState({locked:!1}):(d.setState({locked:!0}),ne()),sessionStorage.setItem("app","false"),$("home"),y()}function ne(){x.get({api:"login/auth_status",end:()=>{d.setState({load:d.getState().load+1})},fail:()=>{window.localStorage.setItem("username","guest"),window.localStorage.setItem("token",""),d.setState({load:d.getState().load+1}),S("guest"),k("")}})}function y(){const t=A();x.post({body:{user:t},api:"home/widget",success:s=>{d.setState({widgetData:s,load:d.getState().load+1})}})}async function ae(){return atob(await Z.get({api:"login/login"}))}async function N(t){let s=await ae(),n=[];for(let a=0;a<t.length;a++)n.push(t.charCodeAt(a)^s.charCodeAt(a%s.length));return btoa(String.fromCharCode(...n))}function oe({showItem:t,type:s,show:n}){return e.jsx("div",{className:"widget-panel "+(n?"widget-hide":""),children:t.map((a,o)=>e.jsxs(G.Fragment,{children:[s=="tra"&&e.jsx("li",{children:i("recent_delete")}),s=="bok"&&e.jsx("li",{children:i("recent_visit")}),e.jsx("div",{className:"widget-panel-item "+s+"-panel",title:i("view"),onClick:c=>{c.stopPropagation(),re(s,a)},children:ie(a,s)})]},a+o))},s+"panel")}function ie(t,s){switch(s){case"pic":return ce(t);case"mon":return le(t);default:return e.jsx("span",{className:"panel-text "+(t==""?"panel-text-null":""),children:t==""?i("empty"):t})}}function le(t){const s=t.split("/");switch(s[0]){case"per_num":return i(s[0])+":"+s[1];default:return i(s[0])+":"+(s[1]=="never"||s[1]=="none"?i(s[1]):s[1]+i(s[2]))}}function ce(t){const s=window.location.origin+"/file/Pictures/"+t.name;return t.media=="img"?e.jsx("img",{src:s,alt:t.name}):t.media=="vid"?e.jsx("video",{src:s,controls:"controls"}):e.jsx("span",{className:"panel-text panel-text-null",children:i("empty")})}function re(t,s){if(t=="tra"){f.normal(i("recent_delete")+":"+s);return}if(t=="mon"){const n=A();f.normal(i("current_user")+":"+n);return}de(t,s)}function de(t,s){const n=H();n[t].list.path=s,Q(n),M(t)}function ue({theme:t,item:s,widgetData:n}){const[a,o]=u.useState(!1);return e.jsx(e.Fragment,{children:e.jsxs("div",{id:s+"widget",className:"widget-item",title:i("enter")+":"+i(s),mode:t.mode,color:t.color[s],onClick:()=>M(s),children:[e.jsx("div",{className:"widget-icon "+(a?"widget-hide":""),children:e.jsx("div",{id:s+"-icon",children:b(s,"base_color")})}),e.jsx(oe,{showItem:n[s],type:s,show:!a}),e.jsx("div",{className:"show-panel btn "+(a?"show-panel-enable":""),title:i("show"),onClick:c=>{c.stopPropagation(),o(!a)},children:m("option")}),e.jsx("span",{className:"widget-title",mode:t.mode,color:t.color.home,children:i(s)})]},s)})}function me({tmpLoad:t}){const s=d(l=>l.locked),n=d(l=>l.widgetData),a=w(l=>l.theme),o=["doc","pic","tra","mon","not","bok"],c=[];for(let l=0;l<o.length;l+=2)c.push(o.slice(l,l+2));return e.jsx("div",{id:"widget",className:!s&&t?"widget-load":"",children:c.map((l,r)=>e.jsx("div",{className:"widget-line",children:l.map(h=>e.jsx(ue,{item:h,theme:a,widgetData:n},h))},`line${r}`))})}function ge(){const t=U(o=>o.lang),[s,n]=u.useState(!1),a={system:i("system"),zh:"简体中文",en:"English"};return e.jsx(e.Fragment,{children:s?e.jsx("div",{id:"lang-list",onClick:()=>{},children:Object.entries(a).map(([o,c])=>e.jsx("div",{className:"lang-list-item "+(o===t.userSelect?"lang-select":""),onClick:async()=>{localStorage.setItem("lang",o),n(!1),B(await V())},children:e.jsx("span",{children:c})},o))}):e.jsxs("div",{id:"show-lang",title:i("switch"),onClick:()=>{n(!0)},children:[e.jsx("span",{children:a[t.userSelect]}),e.jsx("div",{children:m("switch")})]})})}function he(){const[t,s]=u.useState(!1),n=[{id:"cpu",name:i("cpu_usage")},{id:"mem",name:i("mem_usage")},{id:"disk",name:i("disk_usage")}],[a,o]=u.useState({cpu:{data:"",percent:"0%"},mem:{data:"",percent:"0%"},disk:{data:"",percent:"0%"},net:{up:"0.00MB",down:"0.00MB"}});return u.useEffect(()=>{const c=setInterval(()=>{x.get({api:"system/system",loading:!1,success:l=>{o({cpu:{data:"",percent:l.cpuPercent},mem:{data:l.memData,percent:l.memPercent},disk:{data:l.diskData,percent:l.diskPercent},net:{up:l.netUp,down:l.netDown}}),t||s(!0)}})},3e3);return()=>{clearInterval(c)}},[]),e.jsxs("div",{id:"sys-app",children:[t?null:e.jsx("div",{id:"sys-loadPage",children:e.jsx("div",{className:"loading"})}),n.map(c=>e.jsx(G.Fragment,{children:e.jsxs("div",{className:"sys-box",title:c.name,children:[e.jsxs("div",{id:c.id+"-bar",className:"sys-bar",children:[e.jsx("div",{className:"sys-icon",children:b(c.id)}),e.jsx("div",{id:c.id+"-progress-bar",className:"sys-progress-bar",children:e.jsx("div",{className:"sys-progress",style:{width:a[c.id].percent}})}),e.jsx("span",{id:c.id+"-percent",className:"sys-percent",children:a[c.id].percent})]}),e.jsx("span",{className:"sys-data",children:a[c.id].data})]})},c.id)),e.jsxs("div",{id:"net-box",className:"sys-box",title:i("net_usage"),children:[e.jsx("span",{className:"sys-icon",children:b("network")}),e.jsx("div",{className:"sys-icon",children:m("toUp")}),e.jsx("span",{id:"net-up-data",className:"sys-data",children:a.net.up}),e.jsx("div",{className:"sys-icon",children:m("toDown")}),e.jsx("span",{id:"net-down-data",className:"sys-data",children:a.net.down})]})]})}function pe(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function xe(t,s){const n=document.documentElement;n.setAttribute("mode",t),n.setAttribute("color",s);const a=getComputedStyle(n).backgroundColor,o=a.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*[\d.]+)?\)/);let c=a;if(o){const[,r,h,p]=o;c=`#${[r,h,p].map(j=>parseInt(j).toString(16).padStart(2,"0")).join("")}`}let l=document.querySelector('meta[name="theme-color"]');l||(l=document.createElement("meta"),l.name="theme-color",document.head.appendChild(l)),document.documentElement.style.setProperty("--home_head_bar",c),setTimeout(()=>{l.setAttribute("content",c)},100)}function we(){const t=w(r=>r.theme),[s,n]=u.useState("home"),a={system:i("system"),dark:i("dark_mode"),light:i("light_mode")},o=["default","green","blue","orange","yellow","pink","red"],c=()=>{const r=["system","dark","light"],p=(r.indexOf(t.userSelect)+1)%r.length;D("userSelect",r[p])},l=()=>{const r=["home","doc","pic","tra","mon","not","bok"],p=(r.indexOf(s)+1)%r.length;n(r[p])};return e.jsxs("div",{id:"theme-app",children:[e.jsx("div",{id:"mode-bar",children:e.jsxs("button",{id:"show-mode",className:"btn theme-btn",onClick:c,children:[e.jsx("span",{children:a[t.userSelect]}),e.jsx("div",{className:"switch-icon",id:"switch-mode",title:"切换模式",children:m("switch")})]})}),e.jsx("div",{id:"page-bar",children:e.jsxs("button",{id:"show-page",className:"btn theme-btn",onClick:l,children:[e.jsx("span",{children:i(s)}),e.jsx("div",{id:"switch-page",className:"switch-icon",title:i("switch"),children:m("switch")})]})}),e.jsx("div",{id:"color-bar",children:o.map((r,h)=>e.jsx("div",{className:"color-btn "+(t.color[s]===r?"color-btn-enable":""),mode:t.mode,color:r,onClick:()=>D("color",{...t.color,[s]:r}),children:e.jsx("div",{})},h+r))})]})}function D(t,s){const n=w.getState().setTheme,o={...w.getState().theme,[t]:s};t==="userSelect"&&(s==="system"?o.mode=pe():o.mode=s),xe(o.mode,o.color.home),document.body.setAttribute("mode",o.mode),document.body.setAttribute("color",o.color.home),n(o),localStorage.setItem("theme",JSON.stringify(o))}function je({tmpLoad:t,setTmpLoad:s}){const n=U(g=>g.lang),a=d(g=>g.showBg),o=d(g=>g.setGlobal),c=d(g=>g.locked),[l,r]=u.useState(""),h=g=>{r(g),o({showBg:!0})},p=()=>{o({showBg:!1}),r("")},j=()=>h("lang"),P=()=>h("theme"),C=()=>h("sys"),I=()=>{s(!1),setTimeout(()=>{o({locked:!0}),s(!0)},500)};u.useEffect(()=>{X({lang:{name:i("lang_setting"),fun:j},theme:{name:i("theme"),fun:P},sys:{name:i("monitor"),fun:C},lock:{name:i("login_manage"),fun:I}})},[n.type]);const R=[{id:"lang",name:i("lang_setting"),action:j},{id:"theme",name:i("theme"),action:P},{id:"sys",name:i("monitor"),action:C},{id:"lockScreen",name:i("login_manage"),action:I}];return e.jsxs(e.Fragment,{children:[a&&e.jsxs("div",{className:"app-win float-win",children:[e.jsx("button",{className:"btn",id:"close-win",title:i("close"),onClick:p,children:m("no")}),l==="lang"&&e.jsx(ge,{}),l==="sys"&&e.jsx(he,{}),l==="theme"&&e.jsx(we,{})]}),e.jsx("div",{id:"dock",className:!c&&t?"dock-load":"",children:R.map(g=>e.jsx("div",{id:g.id,title:g.name,className:"dock-app",onClick:g.action,children:e.jsx("div",{className:"dock-icon",children:b(g.id)})},g.id))})]})}function fe(){const t=d(a=>a.showBg),[s,n]=u.useState(!0);return e.jsxs(e.Fragment,{children:[e.jsx(Y,{showBg:t}),e.jsx(me,{tmpLoad:s}),e.jsx(je,{tmpLoad:s,setTmpLoad:n})]})}function be({setTmpLoad:t}){return e.jsxs("button",{id:"unlock-btn",className:"btn lock-btn",onClick:()=>{t(!1),setTimeout(()=>{d.setState({locked:!1}),t(!0)},500)},children:[e.jsx("div",{children:m("power")}),e.jsx("span",{children:i("start")})]})}function ke(){const[t,s]=u.useState(!1),n=d(a=>a.load);return u.useEffect(()=>{n==2&&s(!1)},[n]),t?e.jsx("div",{className:"loading",id:"lock-loading",children:" "}):e.jsxs("button",{className:"btn lock-btn",onClick:()=>{s(!0),d.setState({load:0}),F()},children:[e.jsx("div",{children:m("load")}),e.jsx("span",{children:i("refresh")})]})}function Se(){const t=E(s=>s.request.username);return e.jsxs("button",{id:"logout-btn",className:"btn lock-btn "+(t=="guest"?"logout-disabled":""),onClick:()=>ye(),children:[e.jsx("div",{children:m("logout")}),e.jsx("span",{children:i("exit")})]})}async function ye(){await ee.normal(i("are_you_sure"))&&(localStorage.removeItem("token"),localStorage.removeItem("username"),S("guest"),k(""),y(),f.normal(i("logout")))}function Ne({prop:t}){return e.jsxs("div",{id:"btn-box",children:[e.jsx(ke,{}),e.jsx(be,{setTmpLoad:t}),e.jsx(Se,{})]})}function ve({setSwitch:t}){const s=E(n=>n.request.username);return e.jsxs("button",{className:"btn",id:"lock-user",title:i("switch"),onClick:()=>{t(!0)},children:[e.jsx("div",{id:"lock-profile",children:m("user")}),e.jsx("div",{id:"lock-switch",children:m("switch")}),e.jsx("span",{children:s==""||s=="guest"?i("guest"):s})]})}function Pe({prop:t}){return e.jsxs(e.Fragment,{children:[e.jsx(ve,{setSwitch:t.switch}),e.jsx(Ne,{prop:t.unlock})]})}function v({loading:t,send:s}){return e.jsx(e.Fragment,{children:t?e.jsx("div",{className:"loading user-page-loading"}):e.jsx("button",{className:"btn user-page-send",title:i("start"),onClick:()=>s(),children:m("toRight")})})}function Ce({para:t}){const[s,n]=u.useState({userName:"",password:""}),a=o=>{const{name:c,value:l}=o.target;n(r=>({...r,[c]:l}))};return e.jsxs("div",{className:"user-opt-page-win",onKeyDown:o=>t.keyDown(o,()=>L(s.userName,s.password,t)),children:[e.jsx("input",{className:"user-page-input",type:"text",name:"userName",placeholder:i("username"),value:s.userName,onChange:a}),e.jsx("input",{className:"user-page-input",type:"password",name:"password",value:s.password,onChange:a,placeholder:i("password")}),t.loading?e.jsx("div",{className:"loading user-page-loading"}):e.jsx(v,{loading:t.loading,send:()=>L(s.userName,s.password,t)})]})}async function L(t,s,n){n.setLoading(!0);let a=JSON.stringify({name:t,password:s});x.post({api:"login/login",body:{userMes:await N(a)},success:o=>{window.localStorage.setItem("username",t),window.localStorage.setItem("token",o.token),S(t),k(o.token),y(),f.normal(i("login")+":"+t),n.afterSend()},fail:()=>{n.setLoading(!1)}})}function Ie({para:t}){const[s,n]=u.useState({oldPassword:"",newPassword:""}),a=o=>{const{name:c,value:l}=o.target;n(r=>({...r,[c]:l}))};return e.jsxs("div",{className:"user-opt-page-win",onKeyDown:o=>t.keyDown(o,()=>_(s.oldPassword,s.newPassword,t)),children:[e.jsx("input",{className:"user-page-input",type:"password",name:"oldPassword",value:s.oldPassword,onChange:a,placeholder:i("old")+" "+i("password")}),e.jsx("input",{className:"user-page-input",type:"password",name:"newPassword",value:s.newPassword,onChange:a,placeholder:i("new")+" "+i("password")}),e.jsx(v,{loading:t.loading,send:()=>_(s.oldPassword,s.newPassword,t)})]})}async function _(t,s,n){const a=await N(JSON.stringify({oldPas:t,newPas:s}));n.setLoading(!0),x.post({api:"login/modPas",body:{userMes:a},notice:!0,success:o=>{k(o.token),localStorage.setItem("token",o.token),n.afterSend()},fail:()=>{n.setLoading(!1)}})}function De({para:t}){const[s,n]=u.useState({userName:"",password:""}),a=o=>{const{name:c,value:l}=o.target;n(r=>({...r,[c]:l}))};return e.jsxs("div",{className:"user-opt-page-win",onKeyDown:o=>t.keyDown(o,()=>T(s.userName,s.password,t)),children:[e.jsx("input",{className:"user-page-input",type:"text",name:"userName",placeholder:i("new")+" "+i("username"),value:s.userName,onChange:a}),e.jsx("input",{className:"user-page-input",type:"password",name:"password",value:s.password,onChange:a,placeholder:i("password")}),t.loading?e.jsx("div",{className:"loading user-page-loading"}):e.jsx(v,{loading:t.loading,send:()=>T(s.userName,s.password,t)})]})}async function T(t,s,n){d.getState().token;const o=await N(JSON.stringify({name:t,password:s}));n.setLoading(!0),x.post({api:"login/register",body:{userMes:o},notice:!0,success:()=>{n.afterSend()},fail:()=>{n.setLoading(!1)}})}function Le({setSwitch:t}){const[s,n]=u.useState(!1),[a,o]=u.useState("login"),l={keyDown:(h,p)=>{h.key==="Enter"&&(s||p())},setLoading:n,loading:s,afterSend:()=>_e(n,t)},r={login:e.jsx(Ce,{para:l}),modPas:e.jsx(Ie,{para:l}),reg:e.jsx(De,{para:l})};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"user-page-win",children:[e.jsx("button",{className:"btn user-page-back",title:i("back"),onClick:()=>{t(!1)},children:m("toLeft")}),e.jsxs("div",{id:"user-page-btn-bar",children:[e.jsx("button",{disabled:a==="login",className:"btn user-page-btn",title:i("login"),id:"login-btn",onClick:()=>{o("login")},children:m("user")}),e.jsx("button",{disabled:a==="modPas",className:"btn user-page-btn",title:i("modPas"),id:"modPas-btn",onClick:()=>{o("modPas")},children:m("lock")}),e.jsx("button",{disabled:a==="reg",className:"btn user-page-btn",title:i("reg"),id:"reg-btn",onClick:()=>{o("reg")},children:m("newUser")})]}),r[a]]})})}function _e(t,s){t(!1),s(!1)}function Te(){const[t,s]=u.useState(!1),n=d(c=>c.locked),[a,o]=u.useState(!0);return e.jsxs("div",{id:"lock-page",className:n&&a?"lock-page-load":"",children:[e.jsx("div",{id:"head-bar",className:n&&a?"head-bar-load":"",children:e.jsx("div",{id:"head-name"})}),t?e.jsx(Le,{setSwitch:s}):e.jsx(Pe,{prop:{unlock:o,switch:s}})]})}function Be(){const t=w(s=>s.theme);return e.jsxs("div",{id:"app",color:t.color.home,mode:t.mode,children:[e.jsx(Te,{}),e.jsx(fe,{}),e.jsx("div",{className:"wallpaper"}),e.jsx(se,{})]})}F();te.createRoot(document.getElementById("root")).render(e.jsx(Be,{}));
