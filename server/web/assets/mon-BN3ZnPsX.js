import{c as E,A as w,j as e,h as n,q as C,r as l,k as d,n as y,o as k,W as B,f as T,u as I,P as U,t as _}from"./all-DWz_aFjb.js";import{P as G,C as A,T as O,S as W,a as D,H as M,G as P,b as K}from"./page-D4VYC8C6.js";const r=E((t,s)=>{const o=window.localStorage.getItem("userName"),c=window.localStorage.getItem("token");return{userName:o,token:c,nowuser:o?.trim()||"guest",showBg:!1,loading:!1,controlList:null,langList:[],userList:null,showCmd:!1,showLogout:!1,monUrl:`${window.location.origin}/server/mon/`,setGlobal:a=>{t(h=>({...h,...a}))},replaceGlobal:a=>{t(()=>({...a}))},getGlobal:()=>s()}});function F(){G("mon"),L()}function L(){w.get({api:"mon/list",success:t=>{r.setState({controlList:t.control,userList:t.user})}})}function R({keyName:t,Mes:s}){const o=r(c=>c.nowuser);return e.jsx("div",{className:"action-bar "+(s.user.includes(o)?"have-action":"no-action"),title:n("modify_permission"),onClick:()=>{J(t.control,t.action,o,s.user.includes(o)?"remove":"add")},children:n(s.name)})}async function J(t,s,o,c){let a=n(c);await C.normal(a+"?")&&w.patch({api:"mon/update_act",body:{control:t,action:s,name:o,change:c},notice:!0,success:()=>{L()}})}function H({keyName:t,Mes:s}){const[o,c]=l.useState(!1);return s?e.jsxs("div",{className:"control-bar main-item",children:[e.jsx("span",{className:"control-name",children:n(t)}),o?e.jsx("div",{className:"action-list",children:Object.entries(s.action).map(([a,h])=>e.jsx(R,{keyName:{control:t,action:a},Mes:h},t+a))}):null,e.jsx("button",{className:"btn show-action",title:n("show"),onClick:()=>{c(!o)},children:d("setting")})]}):null}function q(){const t=r(s=>s.controlList);return e.jsx(A,{children:t?Object.entries(t).map(([s,o])=>e.jsx(H,{keyName:s,Mes:o},s)):null})}function $({Mes:t}){const[s,o]=l.useState(!1),c=r(m=>m.userList),a=r(m=>m.nowuser),h=r.setState;return e.jsxs("div",{id:"user-box",children:[e.jsx("button",{className:"btn",title:n("view_user"),onClick:()=>{o(!0)},children:d("user")}),e.jsx("span",{id:"user-text",onClick:()=>{o(!0)},children:a}),s?e.jsxs(e.Fragment,{children:[e.jsx("div",{id:"user-list",children:Object.entries(c).map(([m])=>e.jsx("div",{className:"name-item",onClick:()=>{h({nowuser:m}),o(!1)},children:e.jsx("span",{children:m})},m+"nameList"))}),e.jsx("div",{id:"user-back",onClick:()=>{o(!1)}})]}):null]})}function z(){const t={never:n("never"),h:n("hour"),d:n("day"),m:n("month"),y:n("year")},s=r(i=>i.userList),o=r(i=>i.nowuser),c=Object.keys(t),[a,h]=l.useState("h"),[m,j]=l.useState(!1),[p,f]=l.useState(""),g=()=>{const u=(c.indexOf(a)+1)%c.length;h(c[u])},v=i=>{const{value:u}=i.target;f(u)},N=i=>{i.key==="Enter"&&b(p,a)},b=(i,u)=>{let x;if(u=="never")x="never";else{if(!(i>=0)){y.err(n("not_correct"));return}x=i+u}j(!1),f(""),Q(o,x)};return s?e.jsxs("div",{id:"time-box",children:[e.jsx("button",{className:"btn",title:n("mod_log_time"),onClick:()=>j(!m),children:d("time")}),m?e.jsxs(e.Fragment,{children:[e.jsxs("div",{id:"time-input-box",className:"time-text",children:[e.jsx("input",{id:"time-input",placeholder:n("num"),value:p,onChange:v,onKeyDown:N}),e.jsx("button",{className:"btn mini-btn",title:n("save"),onClick:()=>{b(p,a)},children:d("save")})]}),e.jsx("div",{id:"unit-box",children:e.jsxs("div",{id:"unit-text",children:[e.jsx("span",{children:t[a]}),e.jsx("button",{className:"btn mini-btn",title:n("switch"),onClick:g,children:d("switch")})]})})]}):e.jsx("span",{className:"time-text",id:"display-time",title:n("allow_login_time"),children:V(s[o].tokentime)+t[X(s[o].tokentime)]})]}):null}function Q(t,s){w.patch({api:"mon/date",body:{name:t,time:s},notice:!0,success:()=>[L()]})}function V(t){return t=="never"||t==""||!t?"":parseInt(t.slice(0,-1))}function X(t){return t=="never"||t==""||!t?"never":t.slice(-1)}function Y(){const t=r(s=>s.userList);return e.jsxs(O,{children:[e.jsx($,{Mes:t}),e.jsx(z,{})]})}function Z(){const t=()=>{L()};return l.useEffect(()=>{k({load:{name:n("refresh"),fun:t}})},[]),e.jsx("button",{className:"btn side-btn",title:n("refresh"),onClick:t,children:d("load")})}function ee(){const t=()=>{r.setState({showCmd:!0})};return l.useEffect(()=>{k({terminal:{name:n("terminal"),fun:t}})},[]),e.jsx("button",{className:"btn side-btn",title:n("terminal"),onClick:t,children:d("shell")})}function te(){const t=()=>{r.setState({showLogout:!0})};return l.useEffect(()=>{k({logout:{name:n("logout"),fun:t}})},[]),e.jsx("button",{className:"btn side-btn",title:n("logout"),onClick:t,children:d("delUser")})}function se(){return e.jsxs(W,{children:[e.jsx(ee,{}),e.jsx(te,{}),e.jsx(Z,{})]})}function ne(){const t=r(o=>o.showBg),s=r(o=>o.loading);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"loading",id:"list-loading",style:s?{display:"block"}:{display:"none"}}),e.jsx(B,{showBg:t})]})}function oe(){const t=r(i=>i.showCmd),[s,o]=l.useState("输出"),[c,a]=l.useState(""),[h,m]=l.useState(""),[j,p]=l.useState(""),[f,g]=l.useState([]);l.useEffect(()=>{g(JSON.parse(localStorage.getItem("cmdList"))||[])},[]);const v=(i,u)=>{if(h==""||j==""){y.normal(n("none"));return}m(""),p("");const x=[...f,{title:i,cmd:u}];g(x),localStorage.setItem("cmdList",JSON.stringify(x)),y.normal(n("op_com"))},N=async i=>{if(!await C.normal(n("are_you_sure")))return;const u=[...f.slice(0,i),...f.slice(i+1)];g(u),localStorage.setItem("cmdList",JSON.stringify(u))},b=i=>{i.key==="Enter"&&v(h,j)};return e.jsx(B,{showBg:t,children:e.jsxs("div",{id:"cmd-box",children:[e.jsx("button",{className:"btn",id:"close-cmd",title:n("close"),onClick:()=>{r.setState({showCmd:!1})},children:d("no")}),e.jsx("div",{id:"cus-cmd-box",children:f.map((i,u)=>e.jsxs("div",{className:"cmd-item",title:n("run"),onClick:()=>{a(i.cmd),S(i.cmd,o)},children:[e.jsx("button",{className:"del-cmd btn",title:n("delete"),onClick:x=>{x.stopPropagation(),N(u)},children:d("no")}),e.jsx("span",{className:"cmd-title",children:i.title}),e.jsx("span",{className:"cmd-cmd",children:i.cmd})]},u+i.cmd))}),e.jsxs("div",{id:"send-box",className:"cmd-widget",children:[e.jsx("input",{id:"input-cmd",value:c,placeholder:n("cmd"),onKeyDown:i=>{i.key==="Enter"&&S(c,o)},onChange:i=>a(i.target.value)}),e.jsx("pre",{id:"output-text",children:s}),e.jsx("button",{className:"btn",id:"send-cmd",title:n("run"),onClick:()=>{S(c,o)},children:d("toRight")})]}),e.jsxs("div",{id:"cus-cmd-input-bar",className:"cmd-widget",children:[e.jsx("input",{placeholder:n("cus_name"),className:"cmd-input",onKeyDown:b,value:h,onChange:i=>m(i.target.value)}),e.jsx("input",{placeholder:n("cmd"),className:"cmd-input",onKeyDown:b,value:j,onChange:i=>p(i.target.value)}),e.jsx("button",{className:"btn",id:"add-cmd",title:n("add"),onClick:()=>{v(h,j)},children:d("add")})]})]})})}async function S(t,s){await C.normal(n("run")+"?")&&w.post({api:"mon/cmd",body:{cmd:t},success:o=>{s(o)}})}function ie(){const[t,s]=l.useState([]),o=r(c=>c.showLogout);return l.useEffect(()=>{(async()=>{const a=await ae();s(a)})()},[]),e.jsx(B,{showBg:o,children:e.jsxs("div",{id:"user-list-box",children:[e.jsx("button",{id:"close-logout",className:"btn",title:n("close"),onClick:()=>{r.setState({showLogout:!1})},children:d("no")}),t.map(c=>e.jsxs("div",{className:"user-item-box",children:[e.jsx("button",{className:"del-uaer-btn btn",title:n("delete"),onClick:()=>{ce(c,s)},children:d("no")}),e.jsx("span",{className:"user-showname",children:c})]},c+"-user-box"))]})})}async function ce(t,s){await C.normal(n("are_you_sure"))&&w.delete({api:"mon/userList",body:{name:t},notice:!0,success:o=>{s(o)}})}async function ae(){const t=await T.get({api:"mon/userList"});return t||[]}function re(){return e.jsxs(e.Fragment,{children:[e.jsx(oe,{}),e.jsx(ie,{}),e.jsx(ne,{})]})}function le(){const t=I(s=>s.theme);return e.jsxs("div",{id:"app",mode:t.mode,color:t.color.mon,children:[e.jsxs(D,{children:[e.jsx(M,{}),e.jsx(Y,{}),e.jsx(P,{}),e.jsx(K,{})]}),e.jsx(re,{}),e.jsx(se,{}),e.jsx(q,{}),e.jsx(U,{}),e.jsx("div",{className:"wallpaper"})]})}F();_.createRoot(document.getElementById("root")).render(e.jsx(le,{}));
